const _0x3a5777=_0xd8f1;function _0xd8f1(_0x1a09d9,_0x234c24){const _0x18096f=_0x1809();return _0xd8f1=function(_0xd8f132,_0x5f4bfc){_0xd8f132=_0xd8f132-0xa0;let _0x46cb8c=_0x18096f[_0xd8f132];return _0x46cb8c;},_0xd8f1(_0x1a09d9,_0x234c24);}(function(_0x4c2951,_0x3ff0d8){const _0x4ade07=_0xd8f1,_0x3318b0=_0x4c2951();while(!![]){try{const _0x4cafd8=-parseInt(_0x4ade07(0xc7))/0x1*(-parseInt(_0x4ade07(0x13c))/0x2)+-parseInt(_0x4ade07(0x144))/0x3+-parseInt(_0x4ade07(0x13d))/0x4*(-parseInt(_0x4ade07(0x132))/0x5)+parseInt(_0x4ade07(0x134))/0x6+parseInt(_0x4ade07(0x138))/0x7+parseInt(_0x4ade07(0x16a))/0x8+-parseInt(_0x4ade07(0x113))/0x9;if(_0x4cafd8===_0x3ff0d8)break;else _0x3318b0['push'](_0x3318b0['shift']());}catch(_0x3bd2d0){_0x3318b0['push'](_0x3318b0['shift']());}}}(_0x1809,0xe2112));function _0x1809(){const _0x2cea49=['Attempting\x20recovery\x20for\x20wallet\x20\x22','OctraConfig','hashedPassword','Created\x20wallet\x20object:','Resolved\x20private\x20key\x20first\x2020\x20chars:','charCodeAt','Wallet\x20data\x20decrypted\x20successfully','message','activeWalletId','apply','https://octra.network','local','-\x20Public\x20key\x20type:','storage','exportWalletInOfficialFormat','18800496PureXG','toString','warn','===\x20WALLET\x20STORAGE\x20CONSTRUCTOR\x20===','===\x20ALL\x20WALLET\x20RECOVERY\x20STRATEGIES\x20FAILED\x20===','-\x20Wallet\x20name:','===\x20WALLET\x20DATA\x20ENCRYPTION\x20COMPLETE\x20===','createdAt','===\x20LOADING\x20MULTIPLE\x20WALLETS\x20===','encryptedData','===\x20EXPORTING\x20WALLET\x20IN\x20OFFICIAL\x20FORMAT\x20===','-\x20Private\x20key\x20type:','Wallet\x20ID:','null','Using\x20hardcoded\x20salt\x20as\x20fallback\x20(length:','Decrypting\x20wallet:','Removing\x20','===\x20CREATING\x20WALLET\x20OBJECT\x20===','isWalletNameUnique\x20called\x20with\x20undefined\x20name','Found\x20password\x20hash\x20but\x20no\x20salt\x20-\x20generating\x20emergency\x20salt','PBKDF2','toLowerCase','map','push','\x20corrupted\x20wallet(s)\x20to\x20allow\x20fresh\x20start','Failed\x20to\x20cleanup\x20corrupted\x20data:','\x20wallets','Wallet\x20address:','Recovery\x20failed\x20for\x20wallet\x20\x22','===\x20EMERGENCY\x20STORAGE\x20REPAIR\x20COMPLETE\x20===','Number\x20of\x20wallets:','5tFwQUf','Wallet\x20\x22','9302364pXUxfq','startsWith','fromCharCode','Recovery\x20with\x20fallback\x20salt\x20also\x20failed','5119317kTANTd','Official\x20format\x20created:','subtle','deriveKey','2XpjrCn','1522820QmkgsE','wallet_','===\x20CRITICAL:\x20NO\x20SALT\x20FOUND\x20IN\x20STORAGE\x20===','Wallet\x20data\x20encrypted\x20successfully','Failed\x20to\x20load\x20wallets:\x20','===\x20EMERGENCY\x20STORAGE\x20REPAIR\x20START\x20===','split','5006613uDspGp','\x20recovered\x20wallets','-\x20Public\x20key\x20length:','encode','storeWallets','get','Attempting\x20wallet\x20recovery\x20with\x20hardcoded\x20salt...','Re-encrypting\x20','encryptWalletData','Found\x20encrypted\x20wallets\x20but\x20no\x20salt\x20-\x20attempting\x20repair','parse','-\x20Recovered\x20wallet\x20ID:','-\x20Created\x20at:','All\x20','No\x20private\x20key\x20found\x20in\x20wallet\x20data\x20(checked\x20both\x20private_key_b64\x20and\x20privateKey\x20fields)','no-password-mode-salt','===\x20CLEARING\x20ALL\x20WALLET\x20DATA\x20===','importKey','hardcoded-salt','generateWalletId','Failed\x20to\x20store\x20wallets:\x20','Failed\x20to\x20decrypt\x20wallet\x20data:\x20','salt','Cannot\x20store\x20more\x20than\x20','-\x20Wallet\x20ID:','address','WalletStorage','encrypt','Max\x20wallets\x20allowed:','Official\x20format\x20keys:','===\x20WALLET\x20LOADING\x20SUCCESS\x20===','recoverWalletWithFallbackSalt','getRandomValues','octra-no-password-salt','decode','All\x20wallet\x20data\x20cleared\x20successfully','AES-GCM','Emergency\x20repair\x20failed,\x20using\x20hardcoded\x20salt\x20for\x20backward\x20compatibility','2695024fCAjYZ','log','Attempting\x20recovery\x20with\x20','Retrieved\x20metadata\x20for','Using\x20no-password\x20mode\x20-\x20simplified\x20key\x20derivation','Error:','decryptWalletData','===\x20WALLET\x20DATA\x20CLEARING\x20FAILED\x20===','set','This\x20indicates\x20wallets\x20were\x20created\x20without\x20proper\x20salt\x20setup.','simple-salt','Storage\x20updated\x20successfully','===\x20OFFICIAL\x20FORMAT\x20EXPORT\x20COMPLETE\x20===','mnemonic','-\x20Private\x20key\x20length:','_recoveredWithFallbackSalt','Attempting\x20emergency\x20storage\x20repair...','MAX_WALLETS','RPC_URL','publicKey','Corrupted\x20wallet\x20data\x20cleared\x20successfully','decrypt','Active\x20wallet\x20ID:','===\x20IMPORTING\x20WALLET\x20FROM\x20OFFICIAL\x20FORMAT\x20===','Wallet\x20name:','-\x20Address:','\x20wallet(s)\x20are\x20corrupted\x20and\x20cannot\x20be\x20decrypted.\x20Cleanup\x20failed:\x20','slice','===\x20ATTEMPTING\x20WALLET\x20RECOVERY\x20WITH\x20FALLBACK\x20SALT\x20===','===\x20WALLET\x20DATA\x20DECRYPTION\x20COMPLETE\x20===','encryptedWallets','priv','-\x20Name:','toISOString','-\x20Private\x20key\x20first\x2020\x20chars:','public_key_b64','Using\x20hardcoded\x20salt\x20for\x20wallet\x20decryption\x20(length:','substring','Raw\x20wallet\x20data\x20keys:','raw','some','Wallet\x20recovery\x20successful\x20with\x20','===\x20WALLET\x20OBJECT\x20CREATED\x20===','-\x20Recovered\x20wallet\x20address:','===\x20WALLET\x20LOADING\x20FAILED\x20===','addr','Successfully\x20recovered\x20wallet\x20\x22','private_key_b64','1684477fLDakh','===\x20STORING\x20MULTIPLE\x20WALLETS\x20===','1.0','generated','Using\x20stored\x20salt\x20from\x20PasswordManager\x20(length:','Successfully\x20re-encrypted\x20','Resolved\x20public\x20key\x20type:','keys','\x20recovered\x20wallet(s)\x20with\x20proper\x20salt...','substr','Missing\x20\x22addr\x22\x20field\x20in\x20official\x20format','Internal\x20wallet\x20data\x20prepared:','SHA-256','-\x20Recovered\x20wallet\x20name:','===\x20CLEANING\x20UP\x20CORRUPTED\x20WALLET\x20DATA\x20===','privateKey','octra-wallet-salt','===\x20WALLET\x20METADATA\x20RETRIEVED\x20===','emergencyStorageRepair','NETWORK','-\x20addr:','-\x20rpc:','-\x20Wallet\x20address:','length','getWalletCount','Resolved\x20private\x20key\x20type:','name','-\x20Active\x20wallet\x20ID:\x20','===\x20ENCRYPTING\x20WALLET\x20DATA\x20===','createWalletObject','Found','===\x20WALLET\x20STORAGE\x20FAILED\x20===','stringify','encrypted\x20wallets','\x20failed:','===\x20WALLET\x20LOADING\x20COMPLETE\x20===','Using\x20repaired\x20salt\x20(length:','-\x20Decrypted\x20wallet\x20keys:','-\x20Total\x20wallets\x20loaded:\x20','No\x20wallets\x20found\x20in\x20storage','\x22\x20needs\x20re-encryption\x20with\x20proper\x20salt','All\x20wallets\x20stored\x20successfully','===\x20WALLET\x20ENCRYPTION\x20FAILED\x20===','\x22\x20with\x20alternative\x20salt...','===\x20GETTING\x20WALLET\x20METADATA\x20===','Missing\x20\x22priv\x22\x20field\x20in\x20official\x20format','-\x20priv\x20length:','isWalletNameUnique','walletCount','clearAllWallets','Invalid\x20address\x20format\x20in\x20official\x20data\x20-\x20must\x20be\x2047-49\x20characters\x20starting\x20with\x20\x22oct\x22','getWalletMetadata','===\x20WALLET\x20STORAGE\x20COMPLETE\x20===','-\x20Re-encrypted\x20wallets:\x20','===\x20EMERGENCY\x20STORAGE\x20REPAIR\x20FAILED\x20===','Current\x20storage\x20state:','No\x20valid\x20wallets\x20found\x20after\x20decryption','===\x20WALLET\x20RECOVERY\x20COMPLETE\x20===','-\x20ID:','Error\x20getting\x20wallet\x20count:','error'];_0x1809=function(){return _0x2cea49;};return _0x1809();}class WalletStorage{constructor(){const _0x5a8420=_0xd8f1;this[_0x5a8420(0xa8)]=0x5,console[_0x5a8420(0x16b)](_0x5a8420(0x116)),console['log'](_0x5a8420(0x160),this['MAX_WALLETS']);}['createWalletObject'](_0x2ebf3c,_0x5c8a03){const _0x14deac=_0xd8f1;console[_0x14deac(0x16b)](_0x14deac(0x124)),console[_0x14deac(0x16b)](_0x14deac(0xaf),_0x5c8a03),console[_0x14deac(0x16b)](_0x14deac(0xbd),Object[_0x14deac(0xce)](_0x2ebf3c)),console['log']('Raw\x20wallet\x20data\x20address:',_0x2ebf3c[_0x14deac(0x15d)]);const _0x520d1a=_0x2ebf3c['private_key_b64']||_0x2ebf3c[_0x14deac(0xd6)],_0x35f070=_0x2ebf3c[_0x14deac(0xba)]||_0x2ebf3c['publicKey'];console[_0x14deac(0x16b)](_0x14deac(0xe0),typeof _0x520d1a),console[_0x14deac(0x16b)]('Resolved\x20private\x20key\x20length:',_0x520d1a?_0x520d1a['length']:0x0),console['log'](_0x14deac(0x108),_0x520d1a?_0x520d1a['substring'](0x0,0x14):_0x14deac(0x120)),console['log'](_0x14deac(0xcd),typeof _0x35f070),console['log']('Resolved\x20public\x20key\x20length:',_0x35f070?_0x35f070[_0x14deac(0xde)]:0x0);if(!_0x520d1a)throw new Error(_0x14deac(0x152));if(!_0x2ebf3c['address'])throw new Error('No\x20address\x20found\x20in\x20wallet\x20data');const _0x3c7a6b=this[_0x14deac(0x157)](),_0x454bb6=new Date()[_0x14deac(0xb8)](),_0x8cf4b4={'id':_0x3c7a6b,'name':_0x5c8a03,'address':_0x2ebf3c[_0x14deac(0x15d)],'privateKey':_0x520d1a,'publicKey':_0x35f070,'mnemonic':_0x2ebf3c[_0x14deac(0xa4)]||null,'createdAt':_0x454bb6,'updatedAt':_0x454bb6,'isActive':![],'metadata':{'version':_0x14deac(0xc9),'source':_0x14deac(0xca),'icon':null,'color':null,'category':null}};return console['log'](_0x14deac(0x107)),console[_0x14deac(0x16b)](_0x14deac(0x101),_0x8cf4b4['id']),console[_0x14deac(0x16b)](_0x14deac(0xb7),_0x8cf4b4[_0x14deac(0xe1)]),console[_0x14deac(0x16b)]('-\x20Address:',_0x8cf4b4['address']),console[_0x14deac(0x16b)](_0x14deac(0x11e),typeof _0x8cf4b4[_0x14deac(0xd6)]),console[_0x14deac(0x16b)]('-\x20Private\x20key\x20length:',_0x8cf4b4[_0x14deac(0xd6)]?_0x8cf4b4['privateKey'][_0x14deac(0xde)]:0x0),console[_0x14deac(0x16b)](_0x14deac(0xb9),_0x8cf4b4[_0x14deac(0xd6)]?_0x8cf4b4[_0x14deac(0xd6)][_0x14deac(0xbc)](0x0,0x14):_0x14deac(0x120)),console['log'](_0x14deac(0x110),typeof _0x8cf4b4[_0x14deac(0xaa)]),console[_0x14deac(0x16b)](_0x14deac(0x146),_0x8cf4b4[_0x14deac(0xaa)]?_0x8cf4b4[_0x14deac(0xaa)][_0x14deac(0xde)]:0x0),console[_0x14deac(0x16b)](_0x14deac(0x150),_0x8cf4b4[_0x14deac(0x11a)]),console[_0x14deac(0x16b)](_0x14deac(0xc1)),_0x8cf4b4;}[_0x3a5777(0x157)](){const _0x29ff5c=_0x3a5777;return _0x29ff5c(0x13e)+Date['now']()+'_'+Math['random']()[_0x29ff5c(0x114)](0x24)[_0x29ff5c(0xd0)](0x2,0x9);}async[_0x3a5777(0x14c)](_0x1d14b1,_0x33b8b0){const _0x403cd9=_0x3a5777;console['log'](_0x403cd9(0xe3)),console[_0x403cd9(0x16b)](_0x403cd9(0x11f),_0x1d14b1['id']);try{const _0x57a040=JSON[_0x403cd9(0xe7)](_0x1d14b1),_0x3fbf2b=new TextEncoder(),_0x59bdd2=_0x3fbf2b['encode'](_0x57a040),_0x14e369=await this[_0x403cd9(0x13b)](_0x33b8b0),_0x2eb381=crypto[_0x403cd9(0x164)](new Uint8Array(0xc)),_0x22da76=await crypto[_0x403cd9(0x13a)][_0x403cd9(0x15f)]({'name':'AES-GCM','iv':_0x2eb381},_0x14e369,_0x59bdd2),_0x141d29=new Uint8Array(_0x2eb381[_0x403cd9(0xde)]+_0x22da76['byteLength']);_0x141d29['set'](_0x2eb381),_0x141d29[_0x403cd9(0x172)](new Uint8Array(_0x22da76),_0x2eb381[_0x403cd9(0xde)]);const _0x198f6a=btoa(String[_0x403cd9(0x136)](..._0x141d29));return console['log'](_0x403cd9(0x140)),console[_0x403cd9(0x16b)](_0x403cd9(0x119)),_0x198f6a;}catch(_0x3084b4){console[_0x403cd9(0x103)](_0x403cd9(0xf1)),console[_0x403cd9(0x103)](_0x403cd9(0x16f),_0x3084b4['message']);throw new Error('Failed\x20to\x20encrypt\x20wallet\x20data:\x20'+_0x3084b4[_0x403cd9(0x10b)]);}}async[_0x3a5777(0x170)](_0x8dbcb7,_0xa29c32){const _0xfd3f8e=_0x3a5777;console[_0xfd3f8e(0x16b)]('===\x20DECRYPTING\x20WALLET\x20DATA\x20===');try{const _0x1ad06d=new Uint8Array(atob(_0x8dbcb7)[_0xfd3f8e(0x143)]('')[_0xfd3f8e(0x129)](_0x56f0c4=>_0x56f0c4[_0xfd3f8e(0x109)](0x0))),_0x21a09f=_0x1ad06d[_0xfd3f8e(0xb2)](0x0,0xc),_0x275d94=_0x1ad06d[_0xfd3f8e(0xb2)](0xc),_0x3d8478=await this[_0xfd3f8e(0x13b)](_0xa29c32),_0x410009=await crypto[_0xfd3f8e(0x13a)][_0xfd3f8e(0xac)]({'name':'AES-GCM','iv':_0x21a09f},_0x3d8478,_0x275d94),_0x1f28a7=new TextDecoder(),_0x42e9de=_0x1f28a7[_0xfd3f8e(0x166)](_0x410009),_0x526d90=JSON[_0xfd3f8e(0x14e)](_0x42e9de);return console[_0xfd3f8e(0x16b)](_0xfd3f8e(0x10a)),console['log'](_0xfd3f8e(0x15c),_0x526d90['id']),console['log'](_0xfd3f8e(0x118),_0x526d90[_0xfd3f8e(0xe1)]),console[_0xfd3f8e(0x16b)](_0xfd3f8e(0xdd),_0x526d90[_0xfd3f8e(0x15d)]),console[_0xfd3f8e(0x16b)](_0xfd3f8e(0xec),Object['keys'](_0x526d90)),console['log']('-\x20Private\x20key\x20type:',typeof _0x526d90[_0xfd3f8e(0xd6)]),console['log'](_0xfd3f8e(0xa5),_0x526d90[_0xfd3f8e(0xd6)]?_0x526d90[_0xfd3f8e(0xd6)]['length']:0x0),console[_0xfd3f8e(0x16b)]('-\x20Private\x20key\x20first\x2020\x20chars:',_0x526d90['privateKey']?_0x526d90[_0xfd3f8e(0xd6)][_0xfd3f8e(0xbc)](0x0,0x14):_0xfd3f8e(0x120)),console['log']('-\x20Public\x20key\x20type:',typeof _0x526d90[_0xfd3f8e(0xaa)]),console[_0xfd3f8e(0x16b)](_0xfd3f8e(0x146),_0x526d90[_0xfd3f8e(0xaa)]?_0x526d90[_0xfd3f8e(0xaa)][_0xfd3f8e(0xde)]:0x0),console['log'](_0xfd3f8e(0xb4)),_0x526d90;}catch(_0x354a63){console['error']('===\x20WALLET\x20DECRYPTION\x20FAILED\x20==='),console[_0xfd3f8e(0x103)](_0xfd3f8e(0x16f),_0x354a63[_0xfd3f8e(0x10b)]);throw new Error(_0xfd3f8e(0x159)+_0x354a63['message']);}}async[_0x3a5777(0xd9)](){const _0xf9074b=_0x3a5777;console[_0xf9074b(0x16b)](_0xf9074b(0x142));try{const _0x48994c=await chrome[_0xf9074b(0x111)][_0xf9074b(0x10f)][_0xf9074b(0x149)](null);console[_0xf9074b(0x16b)](_0xf9074b(0xfe),Object['keys'](_0x48994c));if(_0x48994c[_0xf9074b(0xb5)]&&!_0x48994c[_0xf9074b(0x15a)]){console['log'](_0xf9074b(0x14d));const _0x1d645b=crypto[_0xf9074b(0x164)](new Uint8Array(0x20)),_0x303362=btoa(String[_0xf9074b(0x136)][_0xf9074b(0x10d)](null,_0x1d645b));return await chrome[_0xf9074b(0x111)][_0xf9074b(0x10f)][_0xf9074b(0x172)]({'salt':_0x303362}),console[_0xf9074b(0x16b)]('Emergency\x20salt\x20generated\x20and\x20stored'),console[_0xf9074b(0x16b)](_0xf9074b(0x14a)),!![];}if(_0x48994c[_0xf9074b(0x106)]&&!_0x48994c['salt']){console[_0xf9074b(0x16b)](_0xf9074b(0x126));const _0x1b1753=crypto[_0xf9074b(0x164)](new Uint8Array(0x20)),_0x3ce47d=btoa(String[_0xf9074b(0x136)][_0xf9074b(0x10d)](null,_0x1b1753));await chrome['storage'][_0xf9074b(0x10f)][_0xf9074b(0x172)]({'salt':_0x3ce47d}),console[_0xf9074b(0x16b)]('Emergency\x20salt\x20created\x20for\x20password\x20verification');}return console[_0xf9074b(0x16b)](_0xf9074b(0x130)),!![];}catch(_0x463b20){return console[_0xf9074b(0x103)](_0xf9074b(0xfd)),console[_0xf9074b(0x103)](_0xf9074b(0x16f),_0x463b20),![];}}async[_0x3a5777(0x13b)](_0x35a780){const _0x597999=_0x3a5777,_0x4d3774=new TextEncoder();if(_0x35a780==='no-password-mode'){console['log'](_0x597999(0x16e));const _0x117cc4=_0x4d3774[_0x597999(0x147)](_0x597999(0x165)),_0x2c5002=await crypto[_0x597999(0x13a)][_0x597999(0x155)](_0x597999(0xbe),_0x4d3774['encode'](_0x35a780),_0x597999(0x127),![],[_0x597999(0x13b)]);return crypto['subtle']['deriveKey']({'name':'PBKDF2','salt':_0x117cc4,'iterations':0x186a0,'hash':_0x597999(0xd3)},_0x2c5002,{'name':_0x597999(0x168),'length':0x100},![],['encrypt',_0x597999(0xac)]);}let _0x53efd7;try{const _0x3df2ca=await chrome['storage'][_0x597999(0x10f)][_0x597999(0x149)](_0x597999(0x15a));if(_0x3df2ca['salt'])_0x53efd7=new Uint8Array(atob(_0x3df2ca[_0x597999(0x15a)])['split']('')['map'](_0x458215=>_0x458215['charCodeAt'](0x0))),console[_0x597999(0x16b)](_0x597999(0xcb),_0x53efd7['length'],')');else{console[_0x597999(0x103)](_0x597999(0x13f)),console[_0x597999(0x103)](_0x597999(0xa0)),console['log'](_0x597999(0xa7));const _0x9c9584=await this[_0x597999(0xd9)]();if(_0x9c9584){const _0x508a8f=await chrome[_0x597999(0x111)][_0x597999(0x10f)]['get'](_0x597999(0x15a));_0x508a8f[_0x597999(0x15a)]?(_0x53efd7=new Uint8Array(atob(_0x508a8f[_0x597999(0x15a)])[_0x597999(0x143)]('')[_0x597999(0x129)](_0x50d9e8=>_0x50d9e8[_0x597999(0x109)](0x0))),console[_0x597999(0x16b)](_0x597999(0xeb),_0x53efd7[_0x597999(0xde)],')')):(console[_0x597999(0x115)](_0x597999(0x169)),_0x53efd7=_0x4d3774[_0x597999(0x147)](_0x597999(0xd7)));}else console['error']('Emergency\x20repair\x20failed,\x20using\x20hardcoded\x20salt'),_0x53efd7=_0x4d3774[_0x597999(0x147)]('octra-wallet-salt');console[_0x597999(0x115)](_0x597999(0xbb),_0x53efd7[_0x597999(0xde)],')');}}catch(_0x18c7f5){console[_0x597999(0x103)]('Failed\x20to\x20get\x20salt\x20from\x20storage:',_0x18c7f5),_0x53efd7=_0x4d3774['encode'](_0x597999(0xd7)),console['warn'](_0x597999(0x121),_0x53efd7[_0x597999(0xde)],')');}const _0x517fd6=await crypto[_0x597999(0x13a)][_0x597999(0x155)](_0x597999(0xbe),_0x4d3774[_0x597999(0x147)](_0x35a780),_0x597999(0x127),![],[_0x597999(0x13b)]);return crypto['subtle'][_0x597999(0x13b)]({'name':_0x597999(0x127),'salt':_0x53efd7,'iterations':0x186a0,'hash':_0x597999(0xd3)},_0x517fd6,{'name':_0x597999(0x168),'length':0x100},![],[_0x597999(0x15f),'decrypt']);}async[_0x3a5777(0x163)](_0x38d86f,_0x1eb562){const _0x358e82=_0x3a5777;console[_0x358e82(0x16b)](_0x358e82(0xb3));const _0x163647=new TextEncoder(),_0x497316=new Uint8Array(atob(_0x38d86f)['split']('')[_0x358e82(0x129)](_0x1a539c=>_0x1a539c[_0x358e82(0x109)](0x0))),_0x2c983a=_0x497316['slice'](0x0,0xc),_0x11f9e7=_0x497316[_0x358e82(0xb2)](0xc),_0xadacf4=[{'name':_0x358e82(0x153),'salt':_0x163647[_0x358e82(0x147)]('octra-no-password-salt')},{'name':_0x358e82(0x156),'salt':_0x163647[_0x358e82(0x147)](_0x358e82(0xd7))},{'name':_0x358e82(0xa1),'salt':_0x163647[_0x358e82(0x147)](_0x358e82(0x15a))}];for(const _0x1b21eb of _0xadacf4){try{console[_0x358e82(0x16b)](_0x358e82(0x16c)+_0x1b21eb[_0x358e82(0xe1)]+'...');const _0x28f6e4=await crypto[_0x358e82(0x13a)][_0x358e82(0x155)](_0x358e82(0xbe),_0x163647[_0x358e82(0x147)](_0x1eb562),_0x358e82(0x127),![],[_0x358e82(0x13b)]),_0x2401ba=await crypto[_0x358e82(0x13a)]['deriveKey']({'name':_0x358e82(0x127),'salt':_0x1b21eb[_0x358e82(0x15a)],'iterations':0x186a0,'hash':_0x358e82(0xd3)},_0x28f6e4,{'name':_0x358e82(0x168),'length':0x100},![],[_0x358e82(0x15f),'decrypt']),_0x1856cd=await crypto[_0x358e82(0x13a)][_0x358e82(0xac)]({'name':_0x358e82(0x168),'iv':_0x2c983a},_0x2401ba,_0x11f9e7),_0x227720=new TextDecoder(),_0x3b900a=_0x227720[_0x358e82(0x166)](_0x1856cd),_0x584b29=JSON['parse'](_0x3b900a);return console['log'](_0x358e82(0xc0)+_0x1b21eb['name']),console['log'](_0x358e82(0x14f),_0x584b29['id']),console[_0x358e82(0x16b)](_0x358e82(0xd4),_0x584b29[_0x358e82(0xe1)]),console[_0x358e82(0x16b)](_0x358e82(0xc2),_0x584b29[_0x358e82(0x15d)]),console[_0x358e82(0x16b)](_0x358e82(0x100)),_0x584b29;}catch(_0x437ebb){console[_0x358e82(0x16b)]('Recovery\x20with\x20'+_0x1b21eb[_0x358e82(0xe1)]+_0x358e82(0xe9),_0x437ebb['message']);}}return console['error'](_0x358e82(0x117)),null;}async[_0x3a5777(0x148)](_0xd6317b,_0x5b107a,_0xc8a916=null){const _0x2416c7=_0x3a5777;console[_0x2416c7(0x16b)](_0x2416c7(0xc8)),console[_0x2416c7(0x16b)](_0x2416c7(0x131),_0xd6317b['length']),console['log'](_0x2416c7(0xad),_0xc8a916);try{if(_0xd6317b[_0x2416c7(0xde)]>this[_0x2416c7(0xa8)])throw new Error(_0x2416c7(0x15b)+this[_0x2416c7(0xa8)]+_0x2416c7(0x12d));const _0x4d35c2=[];for(const _0x46f787 of _0xd6317b){console[_0x2416c7(0x16b)]('Encrypting\x20wallet:',_0x46f787[_0x2416c7(0xe1)]);const _0x1aa608=await this['encryptWalletData'](_0x46f787,_0x5b107a);_0x4d35c2[_0x2416c7(0x12a)]({'id':_0x46f787['id'],'name':_0x46f787[_0x2416c7(0xe1)],'address':_0x46f787['address'],'createdAt':_0x46f787[_0x2416c7(0x11a)],'isActive':_0x46f787['id']===_0xc8a916,'encryptedData':_0x1aa608});}return await chrome[_0x2416c7(0x111)][_0x2416c7(0x10f)][_0x2416c7(0x172)]({'encryptedWallets':_0x4d35c2,'activeWalletId':_0xc8a916,'walletCount':_0xd6317b[_0x2416c7(0xde)]}),console[_0x2416c7(0x16b)](_0x2416c7(0xf0)),console['log'](_0x2416c7(0xfb)),!![];}catch(_0xa13a1){console[_0x2416c7(0x103)](_0x2416c7(0xe6)),console[_0x2416c7(0x103)](_0x2416c7(0x16f),_0xa13a1[_0x2416c7(0x10b)]);throw new Error(_0x2416c7(0x158)+_0xa13a1[_0x2416c7(0x10b)]);}}async['loadWallets'](_0x232e48){const _0x39ae53=_0x3a5777;console[_0x39ae53(0x16b)](_0x39ae53(0x11b));try{const _0x5f1819=await chrome['storage']['local']['get']([_0x39ae53(0xb5),_0x39ae53(0x10c),_0x39ae53(0xf7)]);if(!_0x5f1819[_0x39ae53(0xb5)]||_0x5f1819[_0x39ae53(0xb5)][_0x39ae53(0xde)]===0x0)return console[_0x39ae53(0x16b)](_0x39ae53(0xee)),{'wallets':[],'activeWalletId':null};console['log'](_0x39ae53(0xe5),_0x5f1819[_0x39ae53(0xb5)][_0x39ae53(0xde)],_0x39ae53(0xe8)),console['log'](_0x39ae53(0xad),_0x5f1819[_0x39ae53(0x10c)]);const _0x40571a=[],_0x2e2166=[];for(const _0xfbf123 of _0x5f1819[_0x39ae53(0xb5)]){try{console[_0x39ae53(0x16b)](_0x39ae53(0x122),_0xfbf123[_0x39ae53(0xe1)]);const _0x32d1ef=await this[_0x39ae53(0x170)](_0xfbf123[_0x39ae53(0x11c)],_0x232e48);_0x32d1ef['isActive']=_0x32d1ef['id']===_0x5f1819[_0x39ae53(0x10c)],_0x40571a[_0x39ae53(0x12a)](_0x32d1ef);}catch(_0x411a35){console[_0x39ae53(0x103)]('Failed\x20to\x20decrypt\x20wallet\x20\x22'+_0xfbf123[_0x39ae53(0xe1)]+'\x22:',_0x411a35[_0x39ae53(0x10b)]);try{console['log'](_0x39ae53(0x104)+_0xfbf123[_0x39ae53(0xe1)]+_0x39ae53(0xf2));const _0x5a8c6b=await this['recoverWalletWithFallbackSalt'](_0xfbf123[_0x39ae53(0x11c)],_0x232e48);if(_0x5a8c6b)console['log'](_0x39ae53(0xc5)+_0xfbf123['name']+'\x22\x20with\x20fallback\x20salt'),_0x5a8c6b['isActive']=_0x5a8c6b['id']===_0x5f1819[_0x39ae53(0x10c)],_0x5a8c6b[_0x39ae53(0xa6)]=!![],_0x40571a['push'](_0x5a8c6b);else throw new Error(_0x39ae53(0x137));}catch(_0x52aae1){console[_0x39ae53(0x103)](_0x39ae53(0x12f)+_0xfbf123[_0x39ae53(0xe1)]+'\x22:',_0x52aae1[_0x39ae53(0x10b)]),_0x2e2166[_0x39ae53(0x12a)]({'name':_0xfbf123[_0x39ae53(0xe1)],'address':_0xfbf123['address'],'error':_0x411a35['message'],'recoveryError':_0x52aae1[_0x39ae53(0x10b)]});}}}let _0x4436a5=0x0,_0x28bbf4=![];for(const _0x22ea4e of _0x40571a){_0x22ea4e[_0x39ae53(0xa6)]&&(console[_0x39ae53(0x16b)](_0x39ae53(0x133)+_0x22ea4e['name']+_0x39ae53(0xef)),delete _0x22ea4e[_0x39ae53(0xa6)],_0x4436a5++,_0x28bbf4=!![]);}if(_0x28bbf4||_0x2e2166['length']>0x0){_0x4436a5>0x0&&console[_0x39ae53(0x16b)](_0x39ae53(0x14b)+_0x4436a5+_0x39ae53(0xcf));_0x2e2166['length']>0x0&&console[_0x39ae53(0x115)]('Removing\x20'+_0x2e2166[_0x39ae53(0xde)]+'\x20corrupted\x20wallet(s)\x20from\x20storage');if(_0x40571a[_0x39ae53(0xde)]>0x0)try{await this[_0x39ae53(0x148)](_0x40571a,_0x232e48,_0x5f1819[_0x39ae53(0x10c)]),console[_0x39ae53(0x16b)](_0x39ae53(0xa2)),_0x4436a5>0x0&&console[_0x39ae53(0x16b)](_0x39ae53(0xcc)+_0x4436a5+_0x39ae53(0x145));}catch(_0x5d8376){console[_0x39ae53(0x103)]('Failed\x20to\x20update\x20storage\x20after\x20recovery:',_0x5d8376);}}if(_0x40571a[_0x39ae53(0xde)]===0x0){console[_0x39ae53(0x115)](_0x39ae53(0xff));if(_0x2e2166['length']>0x0){console[_0x39ae53(0x16b)](_0x39ae53(0xd5)),console[_0x39ae53(0x16b)](_0x39ae53(0x123)+_0x2e2166['length']+_0x39ae53(0x12b));try{return await this[_0x39ae53(0xf8)](),console[_0x39ae53(0x16b)](_0x39ae53(0xab)),{'wallets':[],'activeWalletId':null,'recoveredFromCorruption':!![],'corruptedWallets':_0x2e2166,'cleanedUpCorruptedData':!![]};}catch(_0x17c2dc){console[_0x39ae53(0x103)](_0x39ae53(0x12c),_0x17c2dc);throw new Error(_0x39ae53(0x151)+_0x2e2166[_0x39ae53(0xde)]+_0x39ae53(0xb1)+_0x17c2dc[_0x39ae53(0x10b)]+'.\x20Please\x20manually\x20reset\x20the\x20extension.');}}else throw new Error(_0x39ae53(0xee));}return console['log'](_0x39ae53(0x162)),console[_0x39ae53(0x16b)](_0x39ae53(0xed)+_0x40571a[_0x39ae53(0xde)]),console[_0x39ae53(0x16b)](_0x39ae53(0xfc)+_0x4436a5),console[_0x39ae53(0x16b)]('-\x20Corrupted\x20wallets:\x20'+_0x2e2166[_0x39ae53(0xde)]),console[_0x39ae53(0x16b)](_0x39ae53(0xe2)+_0x5f1819[_0x39ae53(0x10c)]),console[_0x39ae53(0x16b)](_0x39ae53(0xea)),{'wallets':_0x40571a,'activeWalletId':_0x5f1819[_0x39ae53(0x10c)],'recoveredFromCorruption':_0x2e2166[_0x39ae53(0xde)]>0x0||_0x4436a5>0x0,'corruptedWallets':_0x2e2166,'reEncryptedWallets':_0x4436a5};}catch(_0x4bd322){console[_0x39ae53(0x103)](_0x39ae53(0xc3)),console[_0x39ae53(0x103)](_0x39ae53(0x16f),_0x4bd322[_0x39ae53(0x10b)]);throw new Error(_0x39ae53(0x141)+_0x4bd322[_0x39ae53(0x10b)]);}}async['getWalletMetadata'](){const _0x20762c=_0x3a5777;console[_0x20762c(0x16b)](_0x20762c(0xf3));try{const _0x5c5a36=await chrome[_0x20762c(0x111)][_0x20762c(0x10f)][_0x20762c(0x149)](['encryptedWallets',_0x20762c(0x10c),_0x20762c(0xf7)]);if(!_0x5c5a36[_0x20762c(0xb5)])return[];const _0x5bdf7a=_0x5c5a36[_0x20762c(0xb5)][_0x20762c(0x129)](_0x5be78a=>({'id':_0x5be78a['id'],'name':_0x5be78a[_0x20762c(0xe1)],'address':_0x5be78a[_0x20762c(0x15d)],'createdAt':_0x5be78a[_0x20762c(0x11a)],'isActive':_0x5be78a['isActive']}));return console[_0x20762c(0x16b)](_0x20762c(0x16d),_0x5bdf7a[_0x20762c(0xde)],'wallets'),console['log'](_0x20762c(0xd8)),_0x5bdf7a;}catch(_0x377e2a){return console[_0x20762c(0x103)]('===\x20WALLET\x20METADATA\x20RETRIEVAL\x20FAILED\x20==='),console[_0x20762c(0x103)](_0x20762c(0x16f),_0x377e2a[_0x20762c(0x10b)]),[];}}async['hasWallets'](){const _0xd65a9a=_0x3a5777;try{const _0x330c95=await chrome[_0xd65a9a(0x111)][_0xd65a9a(0x10f)][_0xd65a9a(0x149)](['encryptedWallets']);return _0x330c95[_0xd65a9a(0xb5)]&&_0x330c95[_0xd65a9a(0xb5)][_0xd65a9a(0xde)]>0x0;}catch(_0x204259){return console['error']('Error\x20checking\x20for\x20wallets:',_0x204259),![];}}async[_0x3a5777(0xdf)](){const _0x19e25a=_0x3a5777;try{const _0x42aa70=await chrome['storage'][_0x19e25a(0x10f)][_0x19e25a(0x149)]([_0x19e25a(0xf7)]);return _0x42aa70[_0x19e25a(0xf7)]||0x0;}catch(_0x5d1f80){return console[_0x19e25a(0x103)](_0x19e25a(0x102),_0x5d1f80),0x0;}}async['canAddMoreWallets'](){const _0x25339a=_0x3a5777,_0xde1c6c=await this[_0x25339a(0xdf)]();return _0xde1c6c<this[_0x25339a(0xa8)];}async[_0x3a5777(0xf6)](_0x581af8,_0x48de9a=null){const _0x1cb0cb=_0x3a5777;if(!_0x581af8)return console['error'](_0x1cb0cb(0x125)),![];const _0x1015fb=await this[_0x1cb0cb(0xfa)]();return!_0x1015fb[_0x1cb0cb(0xbf)](_0x4370d0=>_0x4370d0['name']&&_0x4370d0[_0x1cb0cb(0xe1)][_0x1cb0cb(0x128)]()===_0x581af8[_0x1cb0cb(0x128)]()&&_0x4370d0['id']!==_0x48de9a);}async['isWalletAddressUnique'](_0x42a9c4,_0x1b3b02=null){const _0x2cedb8=_0x3a5777,_0x7c6429=await this[_0x2cedb8(0xfa)]();return!_0x7c6429['some'](_0x5dbd04=>_0x5dbd04[_0x2cedb8(0x15d)]===_0x42a9c4&&_0x5dbd04['id']!==_0x1b3b02);}[_0x3a5777(0x112)](_0x490254,_0x433438){const _0x56697a=_0x3a5777;_0x433438=_0x433438||window[_0x56697a(0x105)]?.[_0x56697a(0xda)]?.[_0x56697a(0xa9)]||_0x56697a(0x10e),console[_0x56697a(0x16b)](_0x56697a(0x11d)),console[_0x56697a(0x16b)](_0x56697a(0xaf),_0x490254[_0x56697a(0xe1)]),console['log'](_0x56697a(0x12e),_0x490254[_0x56697a(0x15d)]);const _0x4ee4d2={'priv':_0x490254[_0x56697a(0xd6)],'addr':_0x490254[_0x56697a(0x15d)],'rpc':_0x433438};return console[_0x56697a(0x16b)](_0x56697a(0x139)),console['log'](_0x56697a(0xf5),_0x4ee4d2['priv']?_0x4ee4d2[_0x56697a(0xb6)][_0x56697a(0xde)]:0x0),console[_0x56697a(0x16b)](_0x56697a(0xdb),_0x4ee4d2[_0x56697a(0xc4)]),console[_0x56697a(0x16b)](_0x56697a(0xdc),_0x4ee4d2['rpc']),console[_0x56697a(0x16b)](_0x56697a(0xa3)),_0x4ee4d2;}['importWalletFromOfficialFormat'](_0x2f4954,_0x5eb82d){const _0x10df0e=_0x3a5777;console['log'](_0x10df0e(0xae)),console[_0x10df0e(0x16b)](_0x10df0e(0x161),Object[_0x10df0e(0xce)](_0x2f4954)),console[_0x10df0e(0x16b)](_0x10df0e(0xaf),_0x5eb82d);if(!_0x2f4954[_0x10df0e(0xb6)])throw new Error(_0x10df0e(0xf4));if(!_0x2f4954['addr'])throw new Error(_0x10df0e(0xd1));if(!_0x2f4954[_0x10df0e(0xc4)][_0x10df0e(0x135)]('oct')||_0x2f4954[_0x10df0e(0xc4)][_0x10df0e(0xde)]<0x2f||_0x2f4954[_0x10df0e(0xc4)]['length']>0x31)throw new Error(_0x10df0e(0xf9));const _0x11f05c={'address':_0x2f4954[_0x10df0e(0xc4)],'private_key_b64':_0x2f4954[_0x10df0e(0xb6)]};return console[_0x10df0e(0x16b)](_0x10df0e(0xd2)),console[_0x10df0e(0x16b)](_0x10df0e(0xb0),_0x11f05c['address']),console[_0x10df0e(0x16b)](_0x10df0e(0xa5),_0x11f05c[_0x10df0e(0xc6)][_0x10df0e(0xde)]),console[_0x10df0e(0x16b)]('===\x20OFFICIAL\x20FORMAT\x20IMPORT\x20COMPLETE\x20==='),this[_0x10df0e(0xe4)](_0x11f05c,_0x5eb82d);}async[_0x3a5777(0xf8)](){const _0x566467=_0x3a5777;console['log'](_0x566467(0x154));try{return await chrome['storage'][_0x566467(0x10f)]['remove']([_0x566467(0xb5),'activeWalletId',_0x566467(0xf7)]),console['log'](_0x566467(0x167)),console[_0x566467(0x16b)]('===\x20WALLET\x20DATA\x20CLEARED\x20==='),!![];}catch(_0x467cfc){return console[_0x566467(0x103)](_0x566467(0x171)),console['error'](_0x566467(0x16f),_0x467cfc[_0x566467(0x10b)]),![];}}}window[_0x3a5777(0x15e)]=WalletStorage;