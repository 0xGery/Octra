const _0x30ab47=_0x504e;(function(_0x1c249f,_0x48aea8){const _0x5235c4=_0x504e,_0x1e3f0c=_0x1c249f();while(!![]){try{const _0x3bbdc3=-parseInt(_0x5235c4(0x157))/0x1+-parseInt(_0x5235c4(0x168))/0x2*(-parseInt(_0x5235c4(0x170))/0x3)+-parseInt(_0x5235c4(0x186))/0x4*(parseInt(_0x5235c4(0x162))/0x5)+-parseInt(_0x5235c4(0x179))/0x6*(parseInt(_0x5235c4(0x17c))/0x7)+parseInt(_0x5235c4(0x159))/0x8*(-parseInt(_0x5235c4(0x148))/0x9)+-parseInt(_0x5235c4(0x17f))/0xa+-parseInt(_0x5235c4(0x14a))/0xb*(-parseInt(_0x5235c4(0x190))/0xc);if(_0x3bbdc3===_0x48aea8)break;else _0x1e3f0c['push'](_0x1e3f0c['shift']());}catch(_0x96de01){_0x1e3f0c['push'](_0x1e3f0c['shift']());}}}(_0x16b3,0xf3e7d));class PasswordManager{constructor(){const _0x3434dc=_0x504e;this['walletManager']=null,this[_0x3434dc(0x163)]=![],this['sessionKey']=null,this['autoLockDuration']=0x12c,this[_0x3434dc(0x158)]=Date[_0x3434dc(0x176)](),this[_0x3434dc(0x18b)]=null,this[_0x3434dc(0x16b)]=null,this[_0x3434dc(0x151)]=null,this['initializeWalletManager'](),this[_0x3434dc(0x191)]();}['initializeWalletManager'](){try{this['walletManager']=new WalletManager(this);}catch(_0x28918f){}}[_0x30ab47(0x13f)](_0x226614){const _0x4f9a36=_0x30ab47;let _0x548938=0x0,_0x2a0a7d=[];if(_0x226614[_0x4f9a36(0x140)]<0x8)_0x548938-=0x2,_0x2a0a7d['push'](_0x4f9a36(0x141));else _0x226614[_0x4f9a36(0x140)]>=0xc&&(_0x548938+=0x2,_0x2a0a7d[_0x4f9a36(0x193)](_0x4f9a36(0x184)));/[A-Z]/[_0x4f9a36(0x14d)](_0x226614)&&(_0x548938+=0x1,_0x2a0a7d[_0x4f9a36(0x193)](_0x4f9a36(0x153)));/[a-z]/[_0x4f9a36(0x14d)](_0x226614)&&(_0x548938+=0x1,_0x2a0a7d['push'](_0x4f9a36(0x14c)));/[0-9]/[_0x4f9a36(0x14d)](_0x226614)&&(_0x548938+=0x1,_0x2a0a7d['push'](_0x4f9a36(0x189)));/[^A-Za-z0-9]/[_0x4f9a36(0x14d)](_0x226614)&&(_0x548938+=0x2,_0x2a0a7d[_0x4f9a36(0x193)](_0x4f9a36(0x192)));let _0x375944=_0x4f9a36(0x14e);if(_0x548938>=0x4)_0x375944=_0x4f9a36(0x13d);else _0x548938>=0x2&&(_0x375944='medium');const _0x20d296={'score':_0x548938,'strength':_0x375944,'feedback':_0x2a0a7d};return _0x20d296;}async[_0x30ab47(0x149)](_0x50d88e){const _0x9a538f=_0x30ab47,_0x1a8f5a=_0x9a538f(0x17e)+Date[_0x9a538f(0x176)]();console[_0x9a538f(0x172)](_0x1a8f5a);try{if(!_0x50d88e||_0x50d88e[_0x9a538f(0x140)]<0x8)return![];const _0x560816=this[_0x9a538f(0x13f)](_0x50d88e);if(_0x560816['strength']===_0x9a538f(0x14e))return![];await chrome[_0x9a538f(0x150)][_0x9a538f(0x169)][_0x9a538f(0x175)](['hashedPassword',_0x9a538f(0x18a)]),await this['initializeStorage'](_0x50d88e);const _0x4a33c5=await chrome[_0x9a538f(0x150)][_0x9a538f(0x169)][_0x9a538f(0x152)]([_0x9a538f(0x18a),_0x9a538f(0x16f)]);if(!_0x4a33c5['salt'])throw new Error(_0x9a538f(0x194));return!![];}catch(_0x3c21da){return![];}finally{console[_0x9a538f(0x17a)](_0x1a8f5a);}}async['skipPasswordSetup'](){const _0x2ff03b=_0x30ab47;try{this[_0x2ff03b(0x15a)]=_0x2ff03b(0x144),await chrome[_0x2ff03b(0x150)]['local'][_0x2ff03b(0x167)]({'passwordSkipped':!![],'sessionKey':this[_0x2ff03b(0x15a)]}),this[_0x2ff03b(0x163)]=!![],await this[_0x2ff03b(0x156)](!![]);if(this[_0x2ff03b(0x147)]){const _0x1057fd=await this[_0x2ff03b(0x147)]['initialize'](this[_0x2ff03b(0x15a)]);if(_0x1057fd){}else{}}return!![];}catch(_0x2d29ca){return![];}finally{}}async[_0x30ab47(0x18f)](){const _0x406f5c=_0x30ab47;try{const _0x5720a7=await chrome[_0x406f5c(0x150)]['local'][_0x406f5c(0x152)]([_0x406f5c(0x16f),_0x406f5c(0x146)]),_0x2f0fae=!!_0x5720a7[_0x406f5c(0x16f)],_0x889640=!!_0x5720a7[_0x406f5c(0x146)];return _0x2f0fae||_0x889640;}catch(_0x1c5d8f){return![];}}async[_0x30ab47(0x181)](_0x1dcaee){const _0x22640d=_0x30ab47;try{const _0x5121d2=new TextEncoder(),_0x13a526=_0x5121d2[_0x22640d(0x13c)](_0x1dcaee),_0x1c468b=await crypto['subtle'][_0x22640d(0x15e)]('SHA-256',_0x13a526),_0x5ec799=Array['from'](new Uint8Array(_0x1c468b)),_0x336864=_0x5ec799[_0x22640d(0x155)](_0x56cddd=>_0x56cddd[_0x22640d(0x165)](0x10)[_0x22640d(0x177)](0x2,'0'))[_0x22640d(0x185)]('');return _0x336864;}catch(_0x41c25f){throw _0x41c25f;}}async[_0x30ab47(0x142)](_0x1f2a31){const _0x1f690d=_0x30ab47;try{const _0x2f7c45=await chrome[_0x1f690d(0x150)][_0x1f690d(0x169)][_0x1f690d(0x152)]([_0x1f690d(0x16f),_0x1f690d(0x18a)]);if(!_0x2f7c45[_0x1f690d(0x16f)])return![];let _0x58a682;if(_0x2f7c45['salt']){const _0x3358e5=new TextEncoder(),_0x397cbb=_0x3358e5[_0x1f690d(0x13c)](_0x1f2a31+_0x2f7c45[_0x1f690d(0x18a)]),_0x12e35b=await window[_0x1f690d(0x16a)][_0x1f690d(0x16e)][_0x1f690d(0x15e)](_0x1f690d(0x145),_0x397cbb),_0x528a2e=Array[_0x1f690d(0x182)](new Uint8Array(_0x12e35b));_0x58a682=_0x528a2e[_0x1f690d(0x155)](_0x3cbbcd=>_0x3cbbcd[_0x1f690d(0x165)](0x10)[_0x1f690d(0x177)](0x2,'0'))[_0x1f690d(0x185)]('');}else _0x58a682=await this[_0x1f690d(0x181)](_0x1f2a31);const _0x4dee37=_0x58a682===_0x2f7c45['hashedPassword'];if(_0x4dee37)this[_0x1f690d(0x15a)]=_0x1f2a31,this[_0x1f690d(0x163)]=!![],await this[_0x1f690d(0x156)]();else{}return _0x4dee37;}catch(_0x250a6f){return![];}finally{}}async[_0x30ab47(0x17b)](){const _0x5dfeef=_0x30ab47;try{this[_0x5dfeef(0x15a)]=null,this['isUnlocked']=![],await chrome[_0x5dfeef(0x150)][_0x5dfeef(0x169)][_0x5dfeef(0x175)]([_0x5dfeef(0x171),_0x5dfeef(0x16c)]),this[_0x5dfeef(0x147)]&&this[_0x5dfeef(0x147)][_0x5dfeef(0x18d)]();}catch(_0x37488c){}finally{}}[_0x30ab47(0x18e)](){const _0x4c85d9=_0x30ab47;return this[_0x4c85d9(0x147)];}[_0x30ab47(0x180)](){return this['isUnlocked'];}[_0x30ab47(0x160)](){const _0xf9ba15=_0x30ab47;this[_0xf9ba15(0x158)]=Date[_0xf9ba15(0x176)](),this[_0xf9ba15(0x151)]&&clearTimeout(this[_0xf9ba15(0x151)]),this['startAutoLockTimer']();}[_0x30ab47(0x173)](){const _0x59bc78=_0x30ab47;this['autoLockTimer']&&clearTimeout(this[_0x59bc78(0x151)]);if(this[_0x59bc78(0x174)]===0x0)return;chrome[_0x59bc78(0x150)]['local'][_0x59bc78(0x152)]([_0x59bc78(0x16f)])[_0x59bc78(0x187)](_0x4d3bd=>{const _0xd1d31f=_0x59bc78,_0x17410c=!!_0x4d3bd[_0xd1d31f(0x16f)];if(!_0x17410c)return;this[_0xd1d31f(0x151)]=setTimeout(()=>{const _0x3041c6=_0xd1d31f;this[_0x3041c6(0x163)]&&this['lockWallet']();},this[_0xd1d31f(0x174)]*0x3e8);});}['updateAutoLockDuration'](_0x5026bf){const _0x29e4ac=_0x30ab47;this[_0x29e4ac(0x174)]=_0x5026bf,this[_0x29e4ac(0x160)]();}async['loadAutoLockSetting'](){const _0x3b90cb=_0x30ab47;try{const _0x2b538c=await chrome[_0x3b90cb(0x150)][_0x3b90cb(0x169)]['get']([_0x3b90cb(0x174)]),_0x22b67e=_0x2b538c[_0x3b90cb(0x174)]!==undefined?_0x2b538c[_0x3b90cb(0x174)]:0x12c;this[_0x3b90cb(0x174)]=_0x22b67e,await this[_0x3b90cb(0x164)](),this[_0x3b90cb(0x173)]();}catch(_0x1de77f){this[_0x3b90cb(0x174)]=0x12c,await this[_0x3b90cb(0x164)](),this['startAutoLockTimer']();}}async[_0x30ab47(0x14b)](_0x101305){const _0x4aa6a2=_0x30ab47;try{const _0x6e4798=await window[_0x4aa6a2(0x16a)]['getRandomValues'](new Uint8Array(0x20)),_0xc968d2=btoa(String[_0x4aa6a2(0x15b)][_0x4aa6a2(0x143)](null,_0x6e4798)),_0x12f9b2=new TextEncoder(),_0x5f4974=_0x12f9b2[_0x4aa6a2(0x13c)](_0x101305+_0xc968d2),_0x3d5126=await window[_0x4aa6a2(0x16a)][_0x4aa6a2(0x16e)][_0x4aa6a2(0x15e)]('SHA-256',_0x5f4974),_0x237545=Array[_0x4aa6a2(0x182)](new Uint8Array(_0x3d5126)),_0x1fa4f5=_0x237545[_0x4aa6a2(0x155)](_0x345402=>_0x345402[_0x4aa6a2(0x165)](0x10)[_0x4aa6a2(0x177)](0x2,'0'))[_0x4aa6a2(0x185)]('');await chrome[_0x4aa6a2(0x150)][_0x4aa6a2(0x169)][_0x4aa6a2(0x167)]({'salt':_0xc968d2,'hashedPassword':_0x1fa4f5,'initialized':!![]}),this['sessionKey']=_0x101305,this[_0x4aa6a2(0x163)]=!![],await this['persistUnlockStatus']();}catch(_0x17a1c6){throw new Error(_0x4aa6a2(0x183)+_0x17a1c6[_0x4aa6a2(0x15d)]);}}async['setPassword'](_0x59051d){const _0x11ec1a=_0x30ab47;try{return await this[_0x11ec1a(0x14b)](_0x59051d),!![];}catch(_0x550401){return![];}}async[_0x30ab47(0x18d)](){const _0x34cb84=_0x30ab47;try{this['sessionKey']=null,this[_0x34cb84(0x163)]=![],await chrome['storage'][_0x34cb84(0x169)][_0x34cb84(0x175)]([_0x34cb84(0x171),_0x34cb84(0x16c)]),this[_0x34cb84(0x147)]&&typeof this[_0x34cb84(0x147)][_0x34cb84(0x18d)]===_0x34cb84(0x13e)&&this[_0x34cb84(0x147)]['clearSensitiveData'](),this['autoLockTimer']&&(clearTimeout(this[_0x34cb84(0x151)]),this[_0x34cb84(0x151)]=null);}catch(_0x151b57){}}async['initializeUnlockStatus'](){const _0x172943=_0x30ab47;try{const _0x51f6ef=await chrome['storage'][_0x172943(0x169)][_0x172943(0x152)]([_0x172943(0x171),_0x172943(0x16c),'passwordSkipped',_0x172943(0x15a)]),_0x34f05d=Date[_0x172943(0x176)]();if(_0x51f6ef[_0x172943(0x146)]){this[_0x172943(0x15a)]=_0x51f6ef[_0x172943(0x15a)]||_0x172943(0x144),this[_0x172943(0x163)]=!![],await this[_0x172943(0x156)](!![]);return;}if(_0x51f6ef['walletUnlocked']&&_0x51f6ef[_0x172943(0x16c)]){const _0x24a57e=_0x34f05d-_0x51f6ef[_0x172943(0x16c)];if(this[_0x172943(0x174)]===0x0){this[_0x172943(0x163)]=!![];if(_0x51f6ef['sessionKey']){this['sessionKey']=_0x51f6ef['sessionKey'];if(this[_0x172943(0x147)]&&!this[_0x172943(0x147)]['isReady']())try{const _0x3f1834=await this['walletManager']['initialize'](this[_0x172943(0x15a)]);if(_0x3f1834){}else{}}catch(_0x4ec353){}}else{}await this[_0x172943(0x156)](![]);}else{const _0x4228d7=this[_0x172943(0x174)]*0x3e8;if(_0x24a57e<_0x4228d7){this[_0x172943(0x163)]=!![];if(_0x51f6ef['sessionKey']){this[_0x172943(0x15a)]=_0x51f6ef[_0x172943(0x15a)];if(this[_0x172943(0x147)]&&!this[_0x172943(0x147)][_0x172943(0x161)]())try{const _0x48219c=await this[_0x172943(0x147)][_0x172943(0x15c)](this[_0x172943(0x15a)]);if(_0x48219c){}else{}}catch(_0x5109c5){}}else{}await this['persistUnlockStatus'](![]);}else this['isUnlocked']=![],await chrome[_0x172943(0x150)][_0x172943(0x169)]['remove'](['walletUnlocked',_0x172943(0x16c)]);}}else this['isUnlocked']=![];}catch(_0x3b8ad0){this[_0x172943(0x163)]=![];}}async[_0x30ab47(0x188)](){const _0x1fd9f9=_0x30ab47;try{this[_0x1fd9f9(0x163)]&&(await chrome[_0x1fd9f9(0x150)][_0x1fd9f9(0x169)][_0x1fd9f9(0x167)]({'lastUnlockTime':Date[_0x1fd9f9(0x176)]()}),this[_0x1fd9f9(0x160)]());}catch(_0x5b3a0d){}}async[_0x30ab47(0x156)](_0x45ab31=!![]){const _0x40dba2=_0x30ab47;try{const _0x20cb06={'walletUnlocked':this[_0x40dba2(0x163)]};if(_0x45ab31)_0x20cb06[_0x40dba2(0x16c)]=Date['now']();else{const _0x17600a=await chrome[_0x40dba2(0x150)][_0x40dba2(0x169)][_0x40dba2(0x152)]([_0x40dba2(0x16c)]);if(_0x17600a['lastUnlockTime'])_0x20cb06['lastUnlockTime']=_0x17600a[_0x40dba2(0x16c)];else{}}await chrome[_0x40dba2(0x150)][_0x40dba2(0x169)][_0x40dba2(0x167)](_0x20cb06);const _0x4b2bf2=await chrome[_0x40dba2(0x150)][_0x40dba2(0x169)]['get']([_0x40dba2(0x171),'lastUnlockTime']);}catch(_0x28a29c){}}async[_0x30ab47(0x17d)](_0x7d6cb5,_0x26853e){const _0x1272ba=_0x30ab47;try{const _0x350ce7=await this[_0x1272ba(0x142)](_0x7d6cb5);if(!_0x350ce7)return{'success':![],'error':_0x1272ba(0x195)};let _0x983146=[];this[_0x1272ba(0x147)]&&this[_0x1272ba(0x147)][_0x1272ba(0x161)]()&&(_0x983146=this[_0x1272ba(0x147)][_0x1272ba(0x166)]());if(!_0x26853e||_0x26853e[_0x1272ba(0x15f)]()===''){await chrome['storage'][_0x1272ba(0x169)][_0x1272ba(0x175)]([_0x1272ba(0x16f),_0x1272ba(0x18a)]),await chrome[_0x1272ba(0x150)][_0x1272ba(0x169)]['set']({'passwordSkipped':!![],'sessionKey':'no-password-mode'}),this[_0x1272ba(0x15a)]='no-password-mode',this['isUnlocked']=!![];if(_0x983146[_0x1272ba(0x140)]>0x0){const _0x1ff3b3=new WalletStorage(),_0x11f6de=_0x983146[_0x1272ba(0x178)](_0x3743ff=>_0x3743ff['isActive'])?.['id']||_0x983146[0x0]?.['id'];await _0x1ff3b3[_0x1272ba(0x154)](_0x983146,_0x1272ba(0x144),_0x11f6de);}return await this[_0x1272ba(0x156)](!![]),{'success':!![]};}if(_0x26853e[_0x1272ba(0x140)]<0x8)return{'success':![],'error':_0x1272ba(0x16d)};const _0xff8d45=this['calculatePasswordStrength'](_0x26853e);if(_0xff8d45[_0x1272ba(0x14f)]===_0x1272ba(0x14e))return{'success':![],'error':_0x1272ba(0x196)};await this[_0x1272ba(0x14b)](_0x26853e),await chrome[_0x1272ba(0x150)][_0x1272ba(0x169)][_0x1272ba(0x175)](['passwordSkipped']);if(_0x983146[_0x1272ba(0x140)]>0x0){const _0x2267d4=new WalletStorage(),_0x445efc=_0x983146['find'](_0x22d073=>_0x22d073[_0x1272ba(0x18c)])?.['id']||_0x983146[0x0]?.['id'];await _0x2267d4['storeWallets'](_0x983146,_0x26853e,_0x445efc);}return{'success':!![]};}catch(_0x3d8674){return{'success':![],'error':_0x3d8674[_0x1272ba(0x15d)]};}finally{}}}function _0x504e(_0x42e949,_0x482b3f){const _0x16b31a=_0x16b3();return _0x504e=function(_0x504eee,_0x1602d1){_0x504eee=_0x504eee-0x13c;let _0x54d4c5=_0x16b31a[_0x504eee];return _0x54d4c5;},_0x504e(_0x42e949,_0x482b3f);}window['PasswordManager']=PasswordManager;function _0x16b3(){const _0x5441bb=['14jHbEWO','changePassword','setupPassword_','14809640LyPmxP','isWalletUnlocked','hashPassword','from','Failed\x20to\x20initialize\x20storage:\x20','Good\x20length','join','148936bJxsnc','then','updateLastActivity','Contains\x20numbers','salt','storageListener','isActive','clearSensitiveData','getWalletManager','isPasswordSet','480VzHebm','loadAutoLockSetting','Contains\x20special\x20characters','push','Failed\x20to\x20store\x20salt\x20during\x20password\x20setup','Current\x20password\x20is\x20incorrect','New\x20password\x20is\x20too\x20weak.\x20Please\x20use\x20a\x20stronger\x20password.','encode','strong','function','calculatePasswordStrength','length','Password\x20is\x20too\x20short','verifyPassword','apply','no-password-mode','SHA-256','passwordSkipped','walletManager','3312918UepwNy','setupPassword','1315974dRSEcZ','initializeStorage','Contains\x20lowercase','test','weak','strength','storage','autoLockTimer','get','Contains\x20uppercase','storeWallets','map','persistUnlockStatus','1076121LBHNkO','lastActivity','8veCNmc','sessionKey','fromCharCode','initialize','message','digest','trim','resetAutoLockTimer','isReady','15DCHzUQ','isUnlocked','initializeUnlockStatus','toString','getAllWallets','set','6DOPmHS','local','crypto','closeListener','lastUnlockTime','New\x20password\x20must\x20be\x20at\x20least\x208\x20characters\x20long','subtle','hashedPassword','160506hyCHGW','walletUnlocked','time','startAutoLockTimer','autoLockDuration','remove','now','padStart','find','2729820OLtEoC','timeEnd','lockWallet'];_0x16b3=function(){return _0x5441bb;};return _0x16b3();}