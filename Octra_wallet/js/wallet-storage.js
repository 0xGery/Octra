const _0x5a1ec0=_0x2616;function _0x2616(_0x19f832,_0x50145f){const _0x2ce67f=_0x2ce6();return _0x2616=function(_0x26168a,_0xaa842f){_0x26168a=_0x26168a-0x185;let _0x195b36=_0x2ce67f[_0x26168a];return _0x195b36;},_0x2616(_0x19f832,_0x50145f);}function _0x2ce6(){const _0x741bd4=['subtle','1182366vMxOKC','2821stEvFQ','Cannot\x20store\x20more\x20than\x20','parse','name','deriveKey','set','Invalid\x20address\x20format\x20in\x20official\x20data\x20-\x20must\x20be\x2047-49\x20characters\x20starting\x20with\x20\x22oct\x22','random','walletCount','address','isActive','private_key_b64','recoverWalletWithFallbackSalt','createdAt','passwordSkipped','now','1976mvULgZ','length','PBKDF2','WalletStorage','canAddMoreWallets','octra-no-password-salt','privateKey','importKey','MAX_WALLETS','Failed\x20to\x20decrypt\x20wallet\x20data:\x20','toLowerCase','priv','Failed\x20to\x20load\x20wallets:\x20','All\x20','addr','raw','Recovery\x20with\x20fallback\x20salt\x20also\x20failed','5TGBxwg','map','hashedPassword','1.0','https://octra.network','AES-GCM','decrypt','wallet_','RPC_URL','activeWalletId','No\x20private\x20key\x20found\x20in\x20wallet\x20data\x20(checked\x20both\x20private_key_b64\x20and\x20privateKey\x20fields)','no-password-mode','107094sEQeYa','No\x20address\x20found\x20in\x20wallet\x20data','some','clearAllWallets','fromCharCode','hasWallets','\x20wallet(s)\x20are\x20corrupted\x20and\x20cannot\x20be\x20decrypted.\x20Cleanup\x20failed:\x20','No\x20wallets\x20found\x20in\x20storage','slice','decryptWalletData','645561vNpJSs','Missing\x20\x22addr\x22\x20field\x20in\x20official\x20format','simple-salt','3003768rvsNsy','isWalletAddressUnique','startsWith','no-password-mode-salt','12979629hHdShx','apply','generateWalletId','encode','salt','SHA-256','toISOString','exportWalletInOfficialFormat','public_key_b64','\x20wallets','split','getWalletMetadata','createWalletObject','decode','getRandomValues','encryptWalletData','local','encryptedData','1587946wUwwuH','getWalletCount','importWalletFromOfficialFormat','encrypt','_recoveredWithFallbackSalt','forEach','NETWORK','get','octra-wallet-salt','charCodeAt','Missing\x20\x22priv\x22\x20field\x20in\x20official\x20format','oct','encryptedWallets','loadWallets','message','OctraConfig','push','substr','toString','storage'];_0x2ce6=function(){return _0x741bd4;};return _0x2ce6();}(function(_0x2cd241,_0x5d13e7){const _0x5a9ce5=_0x2616,_0x24f6f5=_0x2cd241();while(!![]){try{const _0x3af134=-parseInt(_0x5a9ce5(0x19f))/0x1+-parseInt(_0x5a9ce5(0x1b8))/0x2+-parseInt(_0x5a9ce5(0x195))/0x3+parseInt(_0x5a9ce5(0x1a2))/0x4+parseInt(_0x5a9ce5(0x189))/0x5*(-parseInt(_0x5a9ce5(0x1cd))/0x6)+parseInt(_0x5a9ce5(0x1ce))/0x7*(-parseInt(_0x5a9ce5(0x1de))/0x8)+parseInt(_0x5a9ce5(0x1a6))/0x9;if(_0x3af134===_0x5d13e7)break;else _0x24f6f5['push'](_0x24f6f5['shift']());}catch(_0x4e3441){_0x24f6f5['push'](_0x24f6f5['shift']());}}}(_0x2ce6,0x66da9));class WalletStorage{constructor(){const _0x105ac4=_0x2616;this[_0x105ac4(0x1e6)]=0x5;}[_0x5a1ec0(0x1b2)](_0x16cdc4,_0x137a85){const _0x3519f8=_0x5a1ec0,_0x4834b6=_0x16cdc4[_0x3519f8(0x1d9)]||_0x16cdc4[_0x3519f8(0x1e4)],_0x2dc819=_0x16cdc4[_0x3519f8(0x1ae)]||_0x16cdc4['publicKey'];if(!_0x4834b6)throw new Error(_0x3519f8(0x193));if(!_0x16cdc4[_0x3519f8(0x1d7)])throw new Error(_0x3519f8(0x196));const _0x3f7fe8=this[_0x3519f8(0x1a8)](),_0x102b4e=new Date()[_0x3519f8(0x1ac)](),_0x5e0fa3={'id':_0x3f7fe8,'name':_0x137a85,'address':_0x16cdc4['address'],'privateKey':_0x4834b6,'publicKey':_0x2dc819,'mnemonic':_0x16cdc4['mnemonic']||null,'createdAt':_0x102b4e,'updatedAt':_0x102b4e,'isActive':![],'metadata':{'version':_0x3519f8(0x18c),'source':'generated','icon':null,'color':null,'category':null}};return _0x5e0fa3;}['generateWalletId'](){const _0x7ce5de=_0x5a1ec0;return _0x7ce5de(0x190)+Date[_0x7ce5de(0x1dd)]()+'_'+Math[_0x7ce5de(0x1d5)]()[_0x7ce5de(0x1ca)](0x24)[_0x7ce5de(0x1c9)](0x2,0x9);}async[_0x5a1ec0(0x1b5)](_0x28571f,_0x4f6784){const _0x3eeb64=_0x5a1ec0;try{const _0xafb1e9=JSON['stringify'](_0x28571f),_0x103185=new TextEncoder(),_0xae94dd=_0x103185[_0x3eeb64(0x1a9)](_0xafb1e9),_0x3a6581=await this[_0x3eeb64(0x1d2)](_0x4f6784),_0x58775f=crypto[_0x3eeb64(0x1b4)](new Uint8Array(0xc)),_0x19204f=await crypto[_0x3eeb64(0x1cc)][_0x3eeb64(0x1bb)]({'name':_0x3eeb64(0x18e),'iv':_0x58775f},_0x3a6581,_0xae94dd),_0x390680=new Uint8Array(_0x58775f[_0x3eeb64(0x1df)]+_0x19204f['byteLength']);_0x390680[_0x3eeb64(0x1d3)](_0x58775f),_0x390680[_0x3eeb64(0x1d3)](new Uint8Array(_0x19204f),_0x58775f[_0x3eeb64(0x1df)]);const _0x18407d=btoa(String[_0x3eeb64(0x199)](..._0x390680));return _0x18407d;}catch(_0x5b675d){throw new Error('Failed\x20to\x20encrypt\x20wallet\x20data:\x20'+_0x5b675d['message']);}}async[_0x5a1ec0(0x19e)](_0x1c85f2,_0xc26cde){const _0x43bcaf=_0x5a1ec0;try{const _0x344ab6=new Uint8Array(atob(_0x1c85f2)[_0x43bcaf(0x1b0)]('')[_0x43bcaf(0x18a)](_0x1eb0b7=>_0x1eb0b7[_0x43bcaf(0x1c1)](0x0))),_0x59481e=_0x344ab6[_0x43bcaf(0x19d)](0x0,0xc),_0x2e53e1=_0x344ab6[_0x43bcaf(0x19d)](0xc),_0x2bb1de=await this[_0x43bcaf(0x1d2)](_0xc26cde),_0x529ab2=await crypto[_0x43bcaf(0x1cc)][_0x43bcaf(0x18f)]({'name':'AES-GCM','iv':_0x59481e},_0x2bb1de,_0x2e53e1),_0x214d0a=new TextDecoder(),_0x19028f=_0x214d0a[_0x43bcaf(0x1b3)](_0x529ab2),_0x2bc519=JSON[_0x43bcaf(0x1d0)](_0x19028f);return _0x2bc519;}catch(_0x41b6a4){throw new Error(_0x43bcaf(0x1e7)+_0x41b6a4[_0x43bcaf(0x1c6)]);}}async['emergencyStorageRepair'](){const _0x360122=_0x5a1ec0;try{const _0x23ecea=await chrome[_0x360122(0x1cb)][_0x360122(0x1b6)][_0x360122(0x1bf)](null);if(_0x23ecea[_0x360122(0x1c4)]&&!_0x23ecea[_0x360122(0x1aa)]){const _0x3962dc=crypto[_0x360122(0x1b4)](new Uint8Array(0x20)),_0x578236=btoa(String[_0x360122(0x199)][_0x360122(0x1a7)](null,_0x3962dc));return await chrome[_0x360122(0x1cb)][_0x360122(0x1b6)][_0x360122(0x1d3)]({'salt':_0x578236}),!![];}if(_0x23ecea[_0x360122(0x18b)]&&!_0x23ecea[_0x360122(0x1aa)]){const _0x9d34d3=crypto[_0x360122(0x1b4)](new Uint8Array(0x20)),_0x1dbf9e=btoa(String[_0x360122(0x199)]['apply'](null,_0x9d34d3));await chrome[_0x360122(0x1cb)]['local'][_0x360122(0x1d3)]({'salt':_0x1dbf9e});}return!![];}catch(_0x11c075){return![];}}async[_0x5a1ec0(0x1d2)](_0x394827){const _0x3129e7=_0x5a1ec0,_0x2ec557=new TextEncoder();if(_0x394827===_0x3129e7(0x194)){const _0x2a0dee=_0x2ec557[_0x3129e7(0x1a9)](_0x3129e7(0x1e3)),_0x3aef55=await crypto[_0x3129e7(0x1cc)][_0x3129e7(0x1e5)](_0x3129e7(0x187),_0x2ec557[_0x3129e7(0x1a9)](_0x394827),'PBKDF2',![],[_0x3129e7(0x1d2)]);return crypto[_0x3129e7(0x1cc)]['deriveKey']({'name':_0x3129e7(0x1e0),'salt':_0x2a0dee,'iterations':0x186a0,'hash':_0x3129e7(0x1ab)},_0x3aef55,{'name':'AES-GCM','length':0x100},![],['encrypt',_0x3129e7(0x18f)]);}let _0x43cfef;try{const _0x44f078=await chrome[_0x3129e7(0x1cb)][_0x3129e7(0x1b6)][_0x3129e7(0x1bf)]('salt');if(_0x44f078[_0x3129e7(0x1aa)])_0x43cfef=new Uint8Array(atob(_0x44f078[_0x3129e7(0x1aa)])[_0x3129e7(0x1b0)]('')[_0x3129e7(0x18a)](_0x12c7ea=>_0x12c7ea[_0x3129e7(0x1c1)](0x0)));else{const _0x4b9796=await this['emergencyStorageRepair']();if(_0x4b9796){const _0x588493=await chrome[_0x3129e7(0x1cb)][_0x3129e7(0x1b6)][_0x3129e7(0x1bf)](_0x3129e7(0x1aa));_0x588493['salt']?_0x43cfef=new Uint8Array(atob(_0x588493[_0x3129e7(0x1aa)])['split']('')['map'](_0x21d7cf=>_0x21d7cf[_0x3129e7(0x1c1)](0x0))):_0x43cfef=_0x2ec557['encode'](_0x3129e7(0x1c0));}else _0x43cfef=_0x2ec557[_0x3129e7(0x1a9)](_0x3129e7(0x1c0));}}catch(_0x483ec6){_0x43cfef=_0x2ec557[_0x3129e7(0x1a9)](_0x3129e7(0x1c0));}const _0x18b9ae=await crypto[_0x3129e7(0x1cc)][_0x3129e7(0x1e5)]('raw',_0x2ec557[_0x3129e7(0x1a9)](_0x394827),_0x3129e7(0x1e0),![],[_0x3129e7(0x1d2)]);return crypto[_0x3129e7(0x1cc)][_0x3129e7(0x1d2)]({'name':'PBKDF2','salt':_0x43cfef,'iterations':0x186a0,'hash':_0x3129e7(0x1ab)},_0x18b9ae,{'name':'AES-GCM','length':0x100},![],[_0x3129e7(0x1bb),_0x3129e7(0x18f)]);}async['recoverWalletWithFallbackSalt'](_0x3955b5,_0x5f3acc){const _0x1ebd27=_0x5a1ec0,_0x183b9a=new TextEncoder(),_0x357093=new Uint8Array(atob(_0x3955b5)[_0x1ebd27(0x1b0)]('')[_0x1ebd27(0x18a)](_0x33af6e=>_0x33af6e['charCodeAt'](0x0))),_0x5e2e24=_0x357093[_0x1ebd27(0x19d)](0x0,0xc),_0x1e4634=_0x357093[_0x1ebd27(0x19d)](0xc),_0x210b81=[{'name':_0x1ebd27(0x1a5),'salt':_0x183b9a[_0x1ebd27(0x1a9)](_0x1ebd27(0x1e3))},{'name':'hardcoded-salt','salt':_0x183b9a[_0x1ebd27(0x1a9)]('octra-wallet-salt')},{'name':_0x1ebd27(0x1a1),'salt':_0x183b9a['encode'](_0x1ebd27(0x1aa))}];for(const _0x2fa438 of _0x210b81){try{const _0x1e5b25=await crypto[_0x1ebd27(0x1cc)][_0x1ebd27(0x1e5)](_0x1ebd27(0x187),_0x183b9a[_0x1ebd27(0x1a9)](_0x5f3acc),_0x1ebd27(0x1e0),![],['deriveKey']),_0x19aa4c=await crypto[_0x1ebd27(0x1cc)]['deriveKey']({'name':_0x1ebd27(0x1e0),'salt':_0x2fa438[_0x1ebd27(0x1aa)],'iterations':0x186a0,'hash':_0x1ebd27(0x1ab)},_0x1e5b25,{'name':_0x1ebd27(0x18e),'length':0x100},![],[_0x1ebd27(0x1bb),'decrypt']),_0x390652=await crypto[_0x1ebd27(0x1cc)][_0x1ebd27(0x18f)]({'name':_0x1ebd27(0x18e),'iv':_0x5e2e24},_0x19aa4c,_0x1e4634),_0x4dd1d7=new TextDecoder(),_0x1041b3=_0x4dd1d7[_0x1ebd27(0x1b3)](_0x390652),_0x3c5ed9=JSON[_0x1ebd27(0x1d0)](_0x1041b3);return _0x3c5ed9;}catch(_0x4bea63){}}return null;}async['storeWallets'](_0xf0b329,_0x3bc0a2,_0x43e3f4=null){const _0x155e64=_0x5a1ec0;try{if(_0xf0b329['length']>this[_0x155e64(0x1e6)])throw new Error(_0x155e64(0x1cf)+this[_0x155e64(0x1e6)]+_0x155e64(0x1af));const _0x4e3339=[];for(const _0x9b0175 of _0xf0b329){const _0x2fa4d0=await this[_0x155e64(0x1b5)](_0x9b0175,_0x3bc0a2);_0x4e3339[_0x155e64(0x1c8)]({'id':_0x9b0175['id'],'name':_0x9b0175[_0x155e64(0x1d1)],'address':_0x9b0175[_0x155e64(0x1d7)],'createdAt':_0x9b0175[_0x155e64(0x1db)],'isActive':_0x9b0175['id']===_0x43e3f4,'encryptedData':_0x2fa4d0});}return await chrome[_0x155e64(0x1cb)][_0x155e64(0x1b6)]['set']({'encryptedWallets':_0x4e3339,'activeWalletId':_0x43e3f4,'walletCount':_0xf0b329['length']}),!![];}catch(_0x489d97){throw new Error('Failed\x20to\x20store\x20wallets:\x20'+_0x489d97[_0x155e64(0x1c6)]);}}async[_0x5a1ec0(0x1c5)](_0x25b854){const _0x47f00d=_0x5a1ec0;try{const _0x1d8eb7=await chrome[_0x47f00d(0x1cb)][_0x47f00d(0x1b6)][_0x47f00d(0x1bf)](['encryptedWallets',_0x47f00d(0x192),_0x47f00d(0x1d6),_0x47f00d(0x1dc)]);if(!_0x1d8eb7[_0x47f00d(0x1c4)]||_0x1d8eb7[_0x47f00d(0x1c4)][_0x47f00d(0x1df)]===0x0)return{'wallets':[],'activeWalletId':null};_0x1d8eb7[_0x47f00d(0x1c4)][_0x47f00d(0x1bd)]((_0x3f4dc7,_0x287845)=>{});let _0x375e9e=_0x25b854;if(_0x1d8eb7['passwordSkipped']===!![])_0x375e9e='no-password-mode';else{}const _0x15bc77=[],_0x219682=[];for(const _0x5e3406 of _0x1d8eb7[_0x47f00d(0x1c4)]){try{const _0x5349e9=await this['decryptWalletData'](_0x5e3406[_0x47f00d(0x1b7)],_0x375e9e);_0x5349e9[_0x47f00d(0x1d8)]=_0x5349e9['id']===_0x1d8eb7[_0x47f00d(0x192)],_0x15bc77['push'](_0x5349e9);}catch(_0xd72167){try{const _0x4ee134=await this[_0x47f00d(0x1da)](_0x5e3406['encryptedData'],_0x375e9e);if(_0x4ee134)_0x4ee134['isActive']=_0x4ee134['id']===_0x1d8eb7[_0x47f00d(0x192)],_0x4ee134[_0x47f00d(0x1bc)]=!![],_0x15bc77[_0x47f00d(0x1c8)](_0x4ee134);else throw new Error(_0x47f00d(0x188));}catch(_0x403fc0){_0x219682['push']({'name':_0x5e3406[_0x47f00d(0x1d1)],'address':_0x5e3406['address'],'error':_0xd72167[_0x47f00d(0x1c6)],'recoveryError':_0x403fc0[_0x47f00d(0x1c6)]});}}}let _0xf30ce5=0x0,_0x5bf484=![];for(const _0x1d65ad of _0x15bc77){_0x1d65ad[_0x47f00d(0x1bc)]&&(delete _0x1d65ad[_0x47f00d(0x1bc)],_0xf30ce5++,_0x5bf484=!![]);}if(_0x5bf484||_0x219682[_0x47f00d(0x1df)]>0x0){if(_0xf30ce5>0x0){}if(_0x219682[_0x47f00d(0x1df)]>0x0){}if(_0x15bc77[_0x47f00d(0x1df)]>0x0)try{await this['storeWallets'](_0x15bc77,_0x375e9e,_0x1d8eb7[_0x47f00d(0x192)]);if(_0xf30ce5>0x0){}}catch(_0x3ed0e1){}}if(_0x15bc77[_0x47f00d(0x1df)]===0x0){if(_0x219682[_0x47f00d(0x1df)]>0x0)try{return await this[_0x47f00d(0x198)](),{'wallets':[],'activeWalletId':null,'recoveredFromCorruption':!![],'corruptedWallets':_0x219682,'cleanedUpCorruptedData':!![]};}catch(_0x26029c){throw new Error(_0x47f00d(0x185)+_0x219682['length']+_0x47f00d(0x19b)+_0x26029c[_0x47f00d(0x1c6)]+'.\x20Please\x20manually\x20reset\x20the\x20extension.');}else throw new Error(_0x47f00d(0x19c));}return _0x15bc77['forEach']((_0x12991a,_0x42443a)=>{}),{'wallets':_0x15bc77,'activeWalletId':_0x1d8eb7[_0x47f00d(0x192)],'recoveredFromCorruption':_0x219682['length']>0x0||_0xf30ce5>0x0,'corruptedWallets':_0x219682,'reEncryptedWallets':_0xf30ce5};}catch(_0x5ca103){throw new Error(_0x47f00d(0x1ea)+_0x5ca103[_0x47f00d(0x1c6)]);}}async['getWalletMetadata'](){const _0x239877=_0x5a1ec0;try{const _0x52c0d4=await chrome['storage'][_0x239877(0x1b6)][_0x239877(0x1bf)]([_0x239877(0x1c4),_0x239877(0x192),'walletCount']);if(!_0x52c0d4[_0x239877(0x1c4)])return[];const _0x5a6974=_0x52c0d4[_0x239877(0x1c4)]['map'](_0x2b3ac0=>({'id':_0x2b3ac0['id'],'name':_0x2b3ac0[_0x239877(0x1d1)],'address':_0x2b3ac0[_0x239877(0x1d7)],'createdAt':_0x2b3ac0['createdAt'],'isActive':_0x2b3ac0[_0x239877(0x1d8)]}));return _0x5a6974;}catch(_0x59f3ce){return[];}}async[_0x5a1ec0(0x19a)](){const _0x16c3dd=_0x5a1ec0;try{const _0x33089f=await chrome[_0x16c3dd(0x1cb)][_0x16c3dd(0x1b6)][_0x16c3dd(0x1bf)]([_0x16c3dd(0x1c4)]);return _0x33089f['encryptedWallets']&&_0x33089f['encryptedWallets'][_0x16c3dd(0x1df)]>0x0;}catch(_0x451ea5){return![];}}async[_0x5a1ec0(0x1b9)](){const _0x3c5b5d=_0x5a1ec0;try{const _0x109614=await chrome[_0x3c5b5d(0x1cb)][_0x3c5b5d(0x1b6)][_0x3c5b5d(0x1bf)](['walletCount']);return _0x109614[_0x3c5b5d(0x1d6)]||0x0;}catch(_0x54953a){return 0x0;}}async[_0x5a1ec0(0x1e2)](){const _0x115d5c=_0x5a1ec0,_0x502e13=await this[_0x115d5c(0x1b9)]();return _0x502e13<this[_0x115d5c(0x1e6)];}async['isWalletNameUnique'](_0x58ea13,_0x33b81d=null){const _0x8ce0b7=_0x5a1ec0;if(!_0x58ea13)return![];const _0x290bf5=await this[_0x8ce0b7(0x1b1)]();return!_0x290bf5[_0x8ce0b7(0x197)](_0x1dd1dc=>_0x1dd1dc['name']&&_0x1dd1dc[_0x8ce0b7(0x1d1)][_0x8ce0b7(0x1e8)]()===_0x58ea13[_0x8ce0b7(0x1e8)]()&&_0x1dd1dc['id']!==_0x33b81d);}async[_0x5a1ec0(0x1a3)](_0xad371c,_0x11d74f=null){const _0x1d5b4d=_0x5a1ec0,_0x255351=await this[_0x1d5b4d(0x1b1)]();return!_0x255351[_0x1d5b4d(0x197)](_0x2b1457=>_0x2b1457[_0x1d5b4d(0x1d7)]===_0xad371c&&_0x2b1457['id']!==_0x11d74f);}[_0x5a1ec0(0x1ad)](_0xe10505,_0x1d0231){const _0x5c6877=_0x5a1ec0;_0x1d0231=_0x1d0231||window[_0x5c6877(0x1c7)]?.[_0x5c6877(0x1be)]?.[_0x5c6877(0x191)]||_0x5c6877(0x18d);const _0x7b044d={'priv':_0xe10505['privateKey'],'addr':_0xe10505[_0x5c6877(0x1d7)],'rpc':_0x1d0231};return _0x7b044d;}[_0x5a1ec0(0x1ba)](_0x345f56,_0x1a6152){const _0x25759b=_0x5a1ec0;if(!_0x345f56[_0x25759b(0x1e9)])throw new Error(_0x25759b(0x1c2));if(!_0x345f56[_0x25759b(0x186)])throw new Error(_0x25759b(0x1a0));if(!_0x345f56[_0x25759b(0x186)][_0x25759b(0x1a4)](_0x25759b(0x1c3))||_0x345f56[_0x25759b(0x186)][_0x25759b(0x1df)]<0x2f||_0x345f56['addr'][_0x25759b(0x1df)]>0x31)throw new Error(_0x25759b(0x1d4));const _0x3b9d9e={'address':_0x345f56['addr'],'private_key_b64':_0x345f56[_0x25759b(0x1e9)]};return this[_0x25759b(0x1b2)](_0x3b9d9e,_0x1a6152);}async[_0x5a1ec0(0x198)](){const _0x16d814=_0x5a1ec0;try{return await chrome[_0x16d814(0x1cb)]['local']['remove']([_0x16d814(0x1c4),'activeWalletId','walletCount']),!![];}catch(_0x440499){return![];}}}window[_0x5a1ec0(0x1e1)]=WalletStorage;