const _0x208a61=_0x3be0;(function(_0x2a7b62,_0x5afe3e){const _0x1f723c=_0x3be0,_0x12b904=_0x2a7b62();while(!![]){try{const _0x436f3b=parseInt(_0x1f723c(0x10e))/0x1+parseInt(_0x1f723c(0x122))/0x2+-parseInt(_0x1f723c(0x140))/0x3*(-parseInt(_0x1f723c(0xfb))/0x4)+-parseInt(_0x1f723c(0x13e))/0x5+-parseInt(_0x1f723c(0x10d))/0x6*(parseInt(_0x1f723c(0x105))/0x7)+parseInt(_0x1f723c(0xfc))/0x8*(parseInt(_0x1f723c(0x125))/0x9)+parseInt(_0x1f723c(0x14c))/0xa*(-parseInt(_0x1f723c(0x115))/0xb);if(_0x436f3b===_0x5afe3e)break;else _0x12b904['push'](_0x12b904['shift']());}catch(_0x118305){_0x12b904['push'](_0x12b904['shift']());}}}(_0x3efe,0xe089f));function _0x3efe(){const _0x21eb6f=['set','Invalid\x20private\x20key\x20format','sessionKey','setActiveWallet','forEach','map','no-password-mode','mnemonic','message','30cBQkbF','fromSeed','activeWalletId','address','getWalletById','MAX_WALLETS','createdAt','corruptedWallets','3916PxOivP','2129056ZmXdno','checkStateConsistency','clearSensitiveData','find','isReady','deleteWallet','clearRecoveryInfo','metadata','privateKey','7cLFyIb','getActiveWallet','length','local','passwordSkipped','Neither\x20octraCrypto\x20nor\x20CryptoManager\x20class\x20available\x20for\x20wallet\x20generation','octraCrypto','name','3082350kqlUfu','1737280CgTHCb','isActive','renameWallet','imported_key','exportWallet','isWalletAddressUnique','storage','9510039AXRzfi','getStoragePassword','source','lastRecoveryInfo','crypto','base64ToBytes','Imported\x20wallet\x20address\x20already\x20exists','push','icon','walletStorage','wallets','importWallet','get','1751862eylJpB','now','WalletManager','45fRvuKn','isWalletNameUnique','bytesToBase64','createWallet','getAllWallets','generateWallet','activeWallet','clearAllWallets','\x20wallets\x20allowed','getWalletCount','CryptoManager','encryptedWallets','createWalletObject','Wallet\x20name\x20already\x20exists','storeWallets','publicKey','version','Cannot\x20delete\x20the\x20last\x20wallet','getWalletMetadata','cleanedUpCorruptedData','updateActiveWalletInStorage','findIndex','recoveredFromCorruption','isInitialized','Wallet\x20not\x20found','1801375qJIGGL','fixInconsistentState','1359hjXdei','public_key_b64','updatedAt'];_0x3efe=function(){return _0x21eb6f;};return _0x3efe();}function _0x3be0(_0x130679,_0x390dbf){const _0x3efed3=_0x3efe();return _0x3be0=function(_0x3be01e,_0x1f900e){_0x3be01e=_0x3be01e-0xf4;let _0x1fa86f=_0x3efed3[_0x3be01e];return _0x1fa86f;},_0x3be0(_0x130679,_0x390dbf);}class WalletManager{constructor(){const _0x208971=_0x3be0;this[_0x208971(0x11f)]=[],this[_0x208971(0x12b)]=null,this[_0x208971(0xf5)]=null,this[_0x208971(0x11e)]=new WalletStorage(),this[_0x208971(0x13c)]=![];}async['initialize'](_0x4a5686){const _0xafdeef=_0x3be0;try{const _0x2194dd=await chrome[_0xafdeef(0x114)][_0xafdeef(0x108)][_0xafdeef(0x121)]([_0xafdeef(0x109)]);let _0x378be1=_0x4a5686;_0x2194dd[_0xafdeef(0x109)]===!![]&&(_0x378be1='no-password-mode');const _0x3392a8=await this[_0xafdeef(0x11e)]['loadWallets'](_0x378be1);this[_0xafdeef(0x11f)]=_0x3392a8[_0xafdeef(0x11f)],this[_0xafdeef(0xf5)]=_0x3392a8[_0xafdeef(0xf5)],this[_0xafdeef(0x118)]={'recoveredFromCorruption':_0x3392a8[_0xafdeef(0x13b)]||![],'corruptedWallets':_0x3392a8[_0xafdeef(0xfa)]||[],'cleanedUpCorruptedData':_0x3392a8[_0xafdeef(0x138)]||![]};const _0x223eeb=await this[_0xafdeef(0x13f)]();if(_0x223eeb){}this[_0xafdeef(0x11f)][_0xafdeef(0x147)]((_0x57f7a3,_0x369eca)=>{});if(this['activeWalletId']){this['activeWallet']=this['wallets'][_0xafdeef(0xff)](_0x331cd5=>_0x331cd5['id']===this[_0xafdeef(0xf5)]);if(this[_0xafdeef(0x12b)]){}else this[_0xafdeef(0xf5)]=null;}else{}return!this[_0xafdeef(0x12b)]&&this[_0xafdeef(0x11f)][_0xafdeef(0x107)]>0x0&&await this[_0xafdeef(0x146)](this[_0xafdeef(0x11f)][0x0]['id']),this[_0xafdeef(0x13c)]=!![],!![];}catch(_0x3fb73b){return this[_0xafdeef(0x13c)]=![],![];}}['getRecoveryInfo'](){const _0x4a7b2e=_0x3be0;return this[_0x4a7b2e(0x118)]||{'recoveredFromCorruption':![],'corruptedWallets':[]};}[_0x208a61(0x102)](){const _0x2d4972=_0x208a61;this[_0x2d4972(0x118)]={'recoveredFromCorruption':![],'corruptedWallets':[]};}async[_0x208a61(0x128)](_0x2d86ed,_0x484f36,_0x5b3c8b=!![]){const _0x339ae7=_0x208a61,_0x3b1d35=[...this[_0x339ae7(0x11f)]],_0x5d1656=this[_0x339ae7(0x12b)],_0xd1e183=this[_0x339ae7(0xf5)];try{if(this[_0x339ae7(0x11f)][_0x339ae7(0x107)]>=this['walletStorage'][_0x339ae7(0xf8)])throw new Error('Maximum\x20'+this[_0x339ae7(0x11e)][_0x339ae7(0xf8)]+'\x20wallets\x20allowed');const _0xbef354=await this[_0x339ae7(0x11e)][_0x339ae7(0x126)](_0x2d86ed);if(!_0xbef354)throw new Error(_0x339ae7(0x132));if(!window[_0x339ae7(0x119)]||!window[_0x339ae7(0x119)][_0x339ae7(0x12a)]){if(window[_0x339ae7(0x10b)])!window['crypto']&&(window[_0x339ae7(0x119)]={}),!window[_0x339ae7(0x119)][_0x339ae7(0x12a)]&&(window['crypto']['generateWallet']=window['octraCrypto'][_0x339ae7(0x12a)]);else{if(window[_0x339ae7(0x12f)]){const _0x2d2f73=new window[(_0x339ae7(0x12f))]();!window[_0x339ae7(0x119)]&&(window[_0x339ae7(0x119)]={}),!window['crypto']['generateWallet']&&(window[_0x339ae7(0x119)]['generateWallet']=async function(){return await _0x2d2f73['generateKeyPair']();});}else throw new Error(_0x339ae7(0x10a));}}const _0x2e6242=await window[_0x339ae7(0x119)]['generateWallet'](),_0x32bbd9=await this[_0x339ae7(0x11e)][_0x339ae7(0x113)](_0x2e6242[_0x339ae7(0xf6)]);if(!_0x32bbd9)throw new Error('Generated\x20wallet\x20address\x20already\x20exists\x20(very\x20unlikely)');const _0x4af8e9=this[_0x339ae7(0x11e)][_0x339ae7(0x131)](_0x2e6242,_0x2d86ed),_0x49725b=[...this[_0x339ae7(0x11f)],_0x4af8e9];let _0x408749=this[_0x339ae7(0xf5)];_0x5b3c8b&&(_0x4af8e9[_0x339ae7(0x10f)]=!![],_0x408749=_0x4af8e9['id'],_0x49725b[_0x339ae7(0x147)](_0x176288=>{const _0x521c41=_0x339ae7;_0x176288['id']!==_0x4af8e9['id']&&(_0x176288[_0x521c41(0x10f)]=![]);}));const _0x4b37d7=await chrome[_0x339ae7(0x114)][_0x339ae7(0x108)][_0x339ae7(0x121)]([_0x339ae7(0x109)]);let _0x3adb98=_0x484f36;return _0x4b37d7['passwordSkipped']===!![]&&(_0x3adb98=_0x339ae7(0x149)),await this[_0x339ae7(0x11e)]['storeWallets'](_0x49725b,_0x3adb98,_0x408749),this[_0x339ae7(0x11f)]=_0x49725b,this[_0x339ae7(0xf5)]=_0x408749,_0x5b3c8b&&(this[_0x339ae7(0x12b)]=_0x4af8e9),{'success':!![],'wallet':_0x4af8e9};}catch(_0x561c23){return this[_0x339ae7(0x11f)]=_0x3b1d35,this[_0x339ae7(0x12b)]=_0x5d1656,this['activeWalletId']=_0xd1e183,{'success':![],'error':_0x561c23[_0x339ae7(0x14b)]};}}async[_0x208a61(0x120)](_0x505be0,_0x36f7fe,_0xd5f589,_0x51ee8d,_0x2bec1a=!![]){const _0xde5ef6=_0x208a61;try{if(this['wallets']['length']>=this[_0xde5ef6(0x11e)]['MAX_WALLETS'])throw new Error('Maximum\x20'+this[_0xde5ef6(0x11e)][_0xde5ef6(0xf8)]+_0xde5ef6(0x12d));const _0x317ecc=await this[_0xde5ef6(0x11e)][_0xde5ef6(0x126)](_0x505be0);if(!_0x317ecc)throw new Error(_0xde5ef6(0x132));const _0x36c695=await this['walletStorage'][_0xde5ef6(0x113)](_0xd5f589);if(!_0x36c695)throw new Error(_0xde5ef6(0x11b));const _0x7ffefe={'private_key_b64':_0x36f7fe,'address':_0xd5f589};try{const _0x57d017=new CryptoManager(),_0x30bac5=_0x57d017[_0xde5ef6(0x11a)](_0x36f7fe),_0x24d151=nacl['sign']['keyPair'][_0xde5ef6(0xf4)](_0x30bac5);_0x7ffefe[_0xde5ef6(0x141)]=_0x57d017[_0xde5ef6(0x127)](_0x24d151[_0xde5ef6(0x134)]);}catch(_0x43699f){throw new Error(_0xde5ef6(0x144));}const _0x5e0e5f=this[_0xde5ef6(0x11e)]['createWalletObject'](_0x7ffefe,_0x505be0);_0x5e0e5f[_0xde5ef6(0x103)][_0xde5ef6(0x117)]=_0xde5ef6(0x111),this[_0xde5ef6(0x11f)][_0xde5ef6(0x11c)](_0x5e0e5f);_0x2bec1a&&(this['activeWallet']=_0x5e0e5f,this[_0xde5ef6(0xf5)]=_0x5e0e5f['id'],_0x5e0e5f[_0xde5ef6(0x10f)]=!![],this[_0xde5ef6(0x11f)][_0xde5ef6(0x147)](_0x487e9c=>{const _0x5937f5=_0xde5ef6;_0x487e9c['id']!==_0x5e0e5f['id']&&(_0x487e9c[_0x5937f5(0x10f)]=![]);}));const _0xfcde63=await chrome[_0xde5ef6(0x114)][_0xde5ef6(0x108)][_0xde5ef6(0x121)]([_0xde5ef6(0x109)]);let _0x1d6340=_0x51ee8d;return _0xfcde63['passwordSkipped']===!![]&&(_0x1d6340=_0xde5ef6(0x149)),await this['walletStorage'][_0xde5ef6(0x133)](this[_0xde5ef6(0x11f)],_0x1d6340,this[_0xde5ef6(0xf5)]),{'success':!![],'wallet':_0x5e0e5f};}catch(_0x2b2113){return{'success':![],'error':_0x2b2113['message']};}}async[_0x208a61(0x146)](_0x35fab4){const _0x3c0f81=_0x208a61,_0x1f0cbd=Date[_0x3c0f81(0x123)]();try{const _0x57cf74=this[_0x3c0f81(0x11f)][_0x3c0f81(0xff)](_0x5ee1aa=>_0x5ee1aa['id']===_0x35fab4);if(!_0x57cf74)throw new Error('Wallet\x20not\x20found');if(this[_0x3c0f81(0xf5)]===_0x35fab4)return!![];return this[_0x3c0f81(0x12b)]=_0x57cf74,this[_0x3c0f81(0xf5)]=_0x35fab4,this[_0x3c0f81(0x11f)][_0x3c0f81(0x147)](_0xc1ef14=>{const _0x317627=_0x3c0f81;_0xc1ef14[_0x317627(0x10f)]=_0xc1ef14['id']===_0x35fab4;}),await this[_0x3c0f81(0x139)](_0x35fab4),!![];}catch(_0x33c626){return![];}}async[_0x208a61(0x139)](_0x246408){const _0x398d3f=_0x208a61,_0x33d1cf=Date['now']();try{const _0x4141e2=await chrome['storage'][_0x398d3f(0x108)]['get'](['sessionKey',_0x398d3f(0x109)]);let _0x599c63=_0x4141e2[_0x398d3f(0x145)]||_0x398d3f(0x149);_0x4141e2[_0x398d3f(0x109)]===!![]&&(_0x599c63=_0x398d3f(0x149));await chrome[_0x398d3f(0x114)][_0x398d3f(0x108)][_0x398d3f(0x143)]({'activeWalletId':_0x246408});const _0x24bd53=await chrome[_0x398d3f(0x114)]['local'][_0x398d3f(0x121)]([_0x398d3f(0x130)]);if(_0x24bd53['encryptedWallets']){const _0x4332f0=_0x24bd53[_0x398d3f(0x130)][_0x398d3f(0x148)](_0x358f16=>({..._0x358f16,'isActive':_0x358f16['id']===_0x246408}));await chrome[_0x398d3f(0x114)]['local'][_0x398d3f(0x143)]({'encryptedWallets':_0x4332f0});}}catch(_0x14c558){try{const _0x4f482b=Date[_0x398d3f(0x123)](),_0x70439c=await chrome[_0x398d3f(0x114)][_0x398d3f(0x108)]['get']([_0x398d3f(0x145),_0x398d3f(0x109)]);let _0x315742=_0x70439c[_0x398d3f(0x145)]||_0x398d3f(0x149);_0x70439c[_0x398d3f(0x109)]===!![]&&(_0x315742=_0x398d3f(0x149)),await this['walletStorage'][_0x398d3f(0x133)](this[_0x398d3f(0x11f)],_0x315742,this[_0x398d3f(0xf5)]);}catch(_0x3930bf){}}}[_0x208a61(0x106)](){const _0x3958a4=_0x208a61;if(!this[_0x3958a4(0x12b)]){if(this[_0x3958a4(0xf5)]){const _0x1a382b=this[_0x3958a4(0x11f)][_0x3958a4(0xff)](_0x3dafd2=>_0x3dafd2['id']===this[_0x3958a4(0xf5)]);if(_0x1a382b)this[_0x3958a4(0x12b)]=_0x1a382b;else return null;}else return null;}if(!this[_0x3958a4(0x12b)]['privateKey'])return null;if(!this[_0x3958a4(0x12b)][_0x3958a4(0xf6)])return null;return this[_0x3958a4(0x12b)];}[_0x208a61(0x129)](){const _0x254a67=this['wallets']||[];return _0x254a67;}[_0x208a61(0xf7)](_0x3ac9c7){const _0x559ae7=_0x208a61;return this[_0x559ae7(0x11f)][_0x559ae7(0xff)](_0x4d5db8=>_0x4d5db8['id']===_0x3ac9c7)||null;}[_0x208a61(0x137)](){const _0x22bd3c=_0x208a61;return this[_0x22bd3c(0x11f)]['map'](_0x55ad6b=>({'id':_0x55ad6b['id'],'name':_0x55ad6b[_0x22bd3c(0x10c)],'address':_0x55ad6b[_0x22bd3c(0xf6)],'createdAt':_0x55ad6b[_0x22bd3c(0xf9)],'isActive':_0x55ad6b[_0x22bd3c(0x10f)],'metadata':{'source':_0x55ad6b[_0x22bd3c(0x103)][_0x22bd3c(0x117)],'icon':_0x55ad6b[_0x22bd3c(0x103)][_0x22bd3c(0x11d)],'color':_0x55ad6b[_0x22bd3c(0x103)]['color'],'category':_0x55ad6b[_0x22bd3c(0x103)]['category']}}));}async[_0x208a61(0x110)](_0xcefa0b,_0x10c2a1,_0x1066b7){const _0x381699=_0x208a61;try{const _0x1ce35a=this[_0x381699(0x11f)][_0x381699(0xff)](_0x3de09f=>_0x3de09f['id']===_0xcefa0b);if(!_0x1ce35a)throw new Error(_0x381699(0x13d));const _0x2b35b3=await this[_0x381699(0x11e)]['isWalletNameUnique'](_0x10c2a1,_0xcefa0b);if(!_0x2b35b3)throw new Error(_0x381699(0x132));_0x1ce35a[_0x381699(0x10c)]=_0x10c2a1,_0x1ce35a[_0x381699(0x142)]=new Date()['toISOString']();const _0x412f54=await chrome[_0x381699(0x114)][_0x381699(0x108)][_0x381699(0x121)](['passwordSkipped']);let _0x164735=_0x1066b7;return _0x412f54['passwordSkipped']===!![]&&(_0x164735=_0x381699(0x149)),await this[_0x381699(0x11e)][_0x381699(0x133)](this[_0x381699(0x11f)],_0x164735,this[_0x381699(0xf5)]),!![];}catch(_0x445306){return![];}}async[_0x208a61(0x101)](_0x28babf,_0x31bc13){const _0xd63ba8=_0x208a61;try{if(this[_0xd63ba8(0x11f)][_0xd63ba8(0x107)]<=0x1)throw new Error(_0xd63ba8(0x136));const _0x405648=this['wallets'][_0xd63ba8(0x13a)](_0x398f17=>_0x398f17['id']===_0x28babf);if(_0x405648===-0x1)throw new Error(_0xd63ba8(0x13d));const _0x4bc782=this[_0xd63ba8(0x11f)][_0x405648],_0x5842c5=_0x4bc782[_0xd63ba8(0x10f)];this[_0xd63ba8(0x11f)]['splice'](_0x405648,0x1);_0x5842c5&&(this[_0xd63ba8(0x12b)]=this['wallets'][0x0],this[_0xd63ba8(0xf5)]=this[_0xd63ba8(0x11f)][0x0]['id'],this[_0xd63ba8(0x11f)][0x0][_0xd63ba8(0x10f)]=!![]);const _0x2abf26=await chrome['storage'][_0xd63ba8(0x108)][_0xd63ba8(0x121)]([_0xd63ba8(0x109)]);let _0x3d08b4=_0x31bc13;return _0x2abf26['passwordSkipped']===!![]&&(_0x3d08b4=_0xd63ba8(0x149)),await this['walletStorage'][_0xd63ba8(0x133)](this[_0xd63ba8(0x11f)],_0x3d08b4,this[_0xd63ba8(0xf5)]),{'success':!![]};}catch(_0x4eb6ab){return{'success':![],'error':_0x4eb6ab[_0xd63ba8(0x14b)]};}}[_0x208a61(0x112)](_0x1a42ce){const _0x5beeee=_0x208a61;try{const _0x604736=this[_0x5beeee(0x11f)][_0x5beeee(0xff)](_0x13a29d=>_0x13a29d['id']===_0x1a42ce);if(!_0x604736)throw new Error('Wallet\x20not\x20found');const _0x526a31={'name':_0x604736['name'],'address':_0x604736[_0x5beeee(0xf6)],'privateKey':_0x604736['privateKey'],'publicKey':_0x604736['publicKey'],'mnemonic':_0x604736[_0x5beeee(0x14a)],'createdAt':_0x604736[_0x5beeee(0xf9)],'exportedAt':new Date()['toISOString'](),'version':_0x604736[_0x5beeee(0x103)][_0x5beeee(0x135)]};return _0x526a31;}catch(_0x1e6f57){return null;}}async['updateWalletMetadata'](_0x2c116b,_0x479c0c,_0x844898){const _0x3fe585=_0x208a61;try{const _0x49679d=this[_0x3fe585(0x11f)][_0x3fe585(0xff)](_0x54ed54=>_0x54ed54['id']===_0x2c116b);if(!_0x49679d)throw new Error('Wallet\x20not\x20found');_0x49679d[_0x3fe585(0x103)]={..._0x49679d[_0x3fe585(0x103)],..._0x479c0c},_0x49679d[_0x3fe585(0x142)]=new Date()['toISOString']();const _0x3d1a65=await chrome[_0x3fe585(0x114)][_0x3fe585(0x108)][_0x3fe585(0x121)]([_0x3fe585(0x109)]);let _0x210cb7=_0x844898;return _0x3d1a65['passwordSkipped']===!![]&&(_0x210cb7=_0x3fe585(0x149)),await this['walletStorage'][_0x3fe585(0x133)](this[_0x3fe585(0x11f)],_0x210cb7,this[_0x3fe585(0xf5)]),!![];}catch(_0x503ffa){return![];}}[_0x208a61(0x12e)](){const _0x5bb340=_0x208a61;return this[_0x5bb340(0x11f)][_0x5bb340(0x107)];}async[_0x208a61(0xfd)](){const _0x5a6d3f=_0x208a61,_0x2d2120=await this[_0x5a6d3f(0x11e)][_0x5a6d3f(0x137)](),_0x329c3f=this['wallets'][_0x5a6d3f(0x107)],_0x3f8f3c=_0x2d2120[_0x5a6d3f(0x107)];return _0x329c3f!==_0x3f8f3c;}async[_0x208a61(0x13f)](){const _0x515539=_0x208a61,_0x1e2b14=await this['checkStateConsistency']();if(_0x1e2b14&&this[_0x515539(0x11f)][_0x515539(0x107)]===0x0){const _0x412667=await this[_0x515539(0x11e)]['clearAllWallets']();return _0x412667?!![]:![];}return![];}['canAddMoreWallets'](){const _0xd6914b=_0x208a61;return this[_0xd6914b(0x11f)][_0xd6914b(0x107)]<this[_0xd6914b(0x11e)]['MAX_WALLETS'];}[_0x208a61(0x100)](){const _0x522e17=_0x208a61;return this[_0x522e17(0x13c)];}async[_0x208a61(0x116)](_0x4c655a){const _0x29ca62=_0x208a61,_0x40ac2a=await chrome[_0x29ca62(0x114)][_0x29ca62(0x108)]['get']([_0x29ca62(0x109)]);if(_0x40ac2a[_0x29ca62(0x109)]===!![])return'no-password-mode';return _0x4c655a;}[_0x208a61(0xfe)](){const _0x22861e=_0x208a61;try{this[_0x22861e(0x11f)][_0x22861e(0x147)](_0xda5ebf=>{const _0xd03310=_0x22861e;_0xda5ebf['privateKey']&&(_0xda5ebf[_0xd03310(0x104)]=null),_0xda5ebf[_0xd03310(0x134)]&&(_0xda5ebf[_0xd03310(0x134)]=null),_0xda5ebf[_0xd03310(0x14a)]&&(_0xda5ebf[_0xd03310(0x14a)]=null);}),this['activeWallet']=null;}catch(_0x32ad39){}}async[_0x208a61(0x12c)](){const _0x73e62f=_0x208a61;try{return this[_0x73e62f(0x11f)]=[],this[_0x73e62f(0x12b)]=null,this[_0x73e62f(0xf5)]=null,this[_0x73e62f(0x13c)]=![],await this[_0x73e62f(0x11e)][_0x73e62f(0x12c)](),!![];}catch(_0x21a88e){return![];}}}window[_0x208a61(0x124)]=WalletManager;