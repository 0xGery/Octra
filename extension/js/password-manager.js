function _0x30fc(){const _0x56a52c=['Failed\x20to\x20store\x20salt\x20during\x20password\x20setup','local','encode','getRandomValues','Contains\x20numbers','Password\x20hashed\x20successfully','Initializing\x20storage\x20with\x20new\x20password...','Error\x20loading\x20auto-lock\x20setting\x20in\x20PasswordManager:','===\x20LOCK\x20WALLET\x20START\x20===','(Never)','lastUnlockTime','Resetting\x20auto-lock\x20timer','Preserving\x20existing\x20lastUnlockTime\x20-\x20reading\x20from\x20storage','message','Error\x20hashing\x20password:','Checking\x20wallet\x20lock\x20status:','Hashing\x20password...','length','verifyPassword','calculatePasswordStrength','===\x20VERIFY\x20PASSWORD\x20END\x20===','-\x20HashedPassword\x20exists:','digest','time','Auto-lock\x20timer\x20expired\x20-\x20locking\x20wallet','apply','9XHvAzf','===\x20CHANGE\x20PASSWORD\x20START\x20===','===\x20PASSWORD\x20MANAGER\x20CONSTRUCTOR\x20END\x20===','No\x20password\x20set\x20-\x20auto-lock\x20timer\x20will\x20not\x20be\x20started','getAllWallets','Failed\x20to\x20initialize\x20storage:','Updating\x20lastUnlockTime\x20for\x20fresh\x20unlock','loadAutoLockSetting','Wallet\x20locked\x20successfully','getWalletManager','Session\x20key\x20restored\x20for\x20auto-lock\x20disabled\x20state','push','hashedPassword','autoLockDuration','isUnlocked','===\x20VERIFY\x20PASSWORD\x20START\x20===','remove','weak','No\x20previous\x20unlock\x20status\x20found\x20-\x20wallet\x20locked','===\x20CLEARING\x20PASSWORD\x20MANAGER\x20SENSITIVE\x20DATA\x20===','round','Error\x20changing\x20password:','no-password-mode','Checking\x20if\x20password\x20is\x20set...','storeWallets','sessionKey','toString','startAutoLockTimer','strength','Error\x20initializing\x20wallet\x20manager\x20on\x20startup:','Using\x20salt-based\x20password\x20verification','Setting\x20auto-lock\x20timer\x20for\x20','Auto-lock\x20disabled\x20(set\x20to\x20Never)\x20-\x20no\x20timer\x20will\x20be\x20set','Password\x20check\x20result:','Good\x20length','isActive','clearSensitiveData','Wallet\x20manager\x20initialization\x20failed,\x20but\x20continuing...','Initializing\x20wallet\x20manager...','Getting\x20wallet\x20manager:','Wallets\x20re-encrypted\x20with\x20new\x20password','Failed\x20to\x20set\x20password:','salt','Error\x20persisting\x20unlock\x20status:','skipPasswordSetup','Password\x20was\x20skipped\x20-\x20restoring\x20no-password\x20mode','initializeStorage','stack','Unlock\x20status\x20persisted\x20successfully:','crypto','Password\x20setup\x20complete.\x20Wallet\x20unlocked.','53296ceOZxF','join','Contains\x20uppercase','walletUnlocked','Current\x20password\x20verification\x20failed','PasswordManager\x20loading\x20auto-lock\x20setting:','No\x20session\x20key\x20found\x20in\x20storage\x20for\x20unlocked\x20wallet','closeListener','CRITICAL:\x20Salt\x20was\x20not\x20stored\x20properly!','Password\x20changed\x20successfully','Initializing\x20wallet\x20manager\x20with\x20restored\x20session\x20key\x20(auto-lock\x20disabled)...','===\x20SETUP\x20PASSWORD\x20START\x20===','Storage\x20initialized\x20successfully','Initial\x20state:','Persisting\x20unlock\x20status\x20data:','strong','Verification\x20-\x20data\x20saved\x20to\x20storage:','Error\x20locking\x20wallet:','15eVbgNv','Found\x20','set','isReady','padStart','warn','120469OpwknQ','Changing\x20to\x20new\x20password...','Verifying\x20current\x20password...','persistUnlockStatus','Current\x20password\x20is\x20incorrect','setupPassword_','Last\x20activity\x20time\x20updated','Preserved\x20existing\x20lastUnlockTime:','17031XmGHjs','Re-encrypting\x20wallets\x20for\x20no-password\x20mode...','9JmbqpF','then','Password\x20manager\x20sensitive\x20data\x20cleared','error','Wallet\x20manager\x20initialization\x20failed\x20(auto-lock\x20disabled)','lastActivity','Skip\x20password\x20setup\x20completed','\x20existing\x20wallets\x20to\x20re-encrypt','Storage\x20verification\x20after\x20setup:','isWalletUnlocked','autoLockTimer','medium','Password\x20verification\x20failed','Wallet\x20manager\x20initialized\x20successfully','Password\x20strength\x20check:','198538KJQgBa','===\x20SKIP\x20PASSWORD\x20SETUP\x20END\x20===','test','initializeUnlockStatus','428022IMGAJI','Wallets\x20re-encrypted\x20for\x20no-password\x20mode','Failed\x20to\x20initialize\x20wallet\x20manager:','initializeWalletManager','Unlock\x20status\x20initialized:','===\x20SKIP\x20PASSWORD\x20SETUP\x20START\x20===','passwordSkipped','Cleared\x20existing\x20auto-lock\x20timer','No\x20session\x20key\x20found\x20in\x20storage\x20for\x20unlocked\x20wallet\x20(auto-lock\x20disabled)','setPassword','walletManager','\x20seconds)','Password\x20removed\x20successfully\x20-\x20switched\x20to\x20no-password\x20mode','get','Wallet\x20manager\x20initialization\x20failed\x20on\x20startup','hashPassword','Password\x20too\x20weak','fromCharCode','Contains\x20lowercase','initialize','from','map','PasswordManager','Auto-lock\x20timer\x20set\x20successfully','Wallet\x20manager\x20initialized\x20successfully\x20for\x20no-password\x20mode','Password\x20verified.\x20Wallet\x20unlocked.','Using\x20plain\x20password\x20verification\x20(backward\x20compatibility)','Error\x20verifying\x20password:','Error\x20stack:','Auto-lock\x20timer\x20not\x20expired\x20-\x20restoring\x20unlocked\x20state','toISOString','Failed\x20to\x20initialize\x20storage:\x20','Error\x20clearing\x20password\x20manager\x20sensitive\x20data:','===\x20CHANGE\x20PASSWORD\x20END\x20===','Error\x20in\x20setupPassword:','No-password\x20mode\x20restored\x20with\x20session\x20key:','Error\x20skipping\x20password\x20setup:','now','SHA-256','Wallet\x20manager\x20initialized\x20successfully\x20(auto-lock\x20disabled)','Current\x20password\x20verified\x20successfully','log','subtle','Password\x20strength\x20result:','resetAutoLockTimer','2069128SZWZwj','Initializing\x20wallet\x20manager\x20with\x20restored\x20session\x20key...','storage','storageListener','find','No\x20stored\x20password\x20hash\x20found','-\x20Salt\x20exists:','lockWallet','changePassword','Error\x20initializing\x20wallet\x20manager\x20(auto-lock\x20disabled):','Auto-lock\x20disabled\x20-\x20restoring\x20unlocked\x20state','timeEnd','isPasswordSet','13558630MxPRjp'];_0x30fc=function(){return _0x56a52c;};return _0x30fc();}const _0x425f00=_0xd535;function _0xd535(_0x120a38,_0x504274){const _0x30fc07=_0x30fc();return _0xd535=function(_0xd535ce,_0x202e9b){_0xd535ce=_0xd535ce-0x77;let _0x33ce07=_0x30fc07[_0xd535ce];return _0x33ce07;},_0xd535(_0x120a38,_0x504274);}(function(_0x42ae50,_0x52f9bf){const _0x46d20c=_0xd535,_0xdf7fcb=_0x42ae50();while(!![]){try{const _0x1d9db7=parseInt(_0x46d20c(0x79))/0x1+parseInt(_0x46d20c(0x92))/0x2*(-parseInt(_0x46d20c(0xeb))/0x3)+-parseInt(_0x46d20c(0xc3))/0x4+-parseInt(_0x46d20c(0x130))/0x5*(parseInt(_0x46d20c(0x96))/0x6)+-parseInt(_0x46d20c(0x81))/0x7+-parseInt(_0x46d20c(0x11e))/0x8+parseInt(_0x46d20c(0x83))/0x9*(parseInt(_0x46d20c(0xd0))/0xa);if(_0x1d9db7===_0x52f9bf)break;else _0xdf7fcb['push'](_0xdf7fcb['shift']());}catch(_0x583321){_0xdf7fcb['push'](_0xdf7fcb['shift']());}}}(_0x30fc,0x6af79));class PasswordManager{constructor(){const _0x5324f0=_0xd535;console['log']('===\x20PASSWORD\x20MANAGER\x20CONSTRUCTOR\x20START\x20==='),this['walletManager']=null,this[_0x5324f0(0xf9)]=![],this[_0x5324f0(0x104)]=null,this[_0x5324f0(0xf8)]=0x12c,this[_0x5324f0(0x88)]=Date[_0x5324f0(0xbb)](),this[_0x5324f0(0xc6)]=null,this[_0x5324f0(0x125)]=null,this[_0x5324f0(0x8d)]=null,console['log'](_0x5324f0(0x12b),{'hasWalletManager':!!this[_0x5324f0(0xa0)],'isUnlocked':this[_0x5324f0(0xf9)],'autoLockDuration':this[_0x5324f0(0xf8)],'lastActivity':new Date(this['lastActivity'])[_0x5324f0(0xb4)]()}),this[_0x5324f0(0x99)](),this[_0x5324f0(0xf2)](),console[_0x5324f0(0xbf)](_0x5324f0(0xed));}['initializeWalletManager'](){const _0x3234d9=_0xd535;console[_0x3234d9(0xbf)](_0x3234d9(0x111));try{this['walletManager']=new WalletManager(this),console[_0x3234d9(0xbf)](_0x3234d9(0x90));}catch(_0x4fdc25){console['error'](_0x3234d9(0x98),_0x4fdc25),console['error'](_0x3234d9(0xb2),_0x4fdc25['stack']);}}[_0x425f00(0xe4)](_0x267672){const _0x564cc0=_0x425f00;console[_0x564cc0(0xbf)]('Calculating\x20password\x20strength...');let _0x4f6264=0x0,_0x4d9d55=[];if(_0x267672[_0x564cc0(0xe2)]<0x8)_0x4f6264-=0x2,_0x4d9d55['push']('Password\x20is\x20too\x20short');else _0x267672[_0x564cc0(0xe2)]>=0xc&&(_0x4f6264+=0x2,_0x4d9d55[_0x564cc0(0xf6)](_0x564cc0(0x10d)));/[A-Z]/['test'](_0x267672)&&(_0x4f6264+=0x1,_0x4d9d55[_0x564cc0(0xf6)](_0x564cc0(0x120)));/[a-z]/[_0x564cc0(0x94)](_0x267672)&&(_0x4f6264+=0x1,_0x4d9d55[_0x564cc0(0xf6)](_0x564cc0(0xa8)));/[0-9]/[_0x564cc0(0x94)](_0x267672)&&(_0x4f6264+=0x1,_0x4d9d55[_0x564cc0(0xf6)](_0x564cc0(0xd5)));/[^A-Za-z0-9]/[_0x564cc0(0x94)](_0x267672)&&(_0x4f6264+=0x2,_0x4d9d55[_0x564cc0(0xf6)]('Contains\x20special\x20characters'));let _0x150f41='weak';if(_0x4f6264>=0x4)_0x150f41=_0x564cc0(0x12d);else _0x4f6264>=0x2&&(_0x150f41=_0x564cc0(0x8e));const _0x311796={'score':_0x4f6264,'strength':_0x150f41,'feedback':_0x4d9d55};return console[_0x564cc0(0xbf)](_0x564cc0(0xc1),_0x311796),_0x311796;}async['setupPassword'](_0x30d0ab){const _0x4bc339=_0x425f00;console['log'](_0x4bc339(0x129));const _0x4df560=_0x4bc339(0x7e)+Date[_0x4bc339(0xbb)]();console[_0x4bc339(0xe8)](_0x4df560);try{console[_0x4bc339(0xbf)]('Validating\x20password...');if(!_0x30d0ab||_0x30d0ab['length']<0x8)return console[_0x4bc339(0x86)]('Invalid\x20password:',{'length':_0x30d0ab?.[_0x4bc339(0xe2)]}),![];const _0x26735d=this[_0x4bc339(0xe4)](_0x30d0ab);console[_0x4bc339(0xbf)](_0x4bc339(0x91),_0x26735d);if(_0x26735d[_0x4bc339(0x107)]==='weak')return console['warn'](_0x4bc339(0xa6)),![];console[_0x4bc339(0xbf)]('Force\x20creating\x20salt\x20and\x20initializing\x20storage...'),await chrome[_0x4bc339(0xc5)][_0x4bc339(0xd2)][_0x4bc339(0xfb)]([_0x4bc339(0xf7),_0x4bc339(0x115)]),await this[_0x4bc339(0x119)](_0x30d0ab);const _0x326b14=await chrome[_0x4bc339(0xc5)]['local'][_0x4bc339(0xa3)]([_0x4bc339(0x115),_0x4bc339(0xf7)]);console['log'](_0x4bc339(0x8b)),console['log'](_0x4bc339(0xc9),!!_0x326b14[_0x4bc339(0x115)]),console['log']('-\x20Salt\x20length:',_0x326b14[_0x4bc339(0x115)]?_0x326b14[_0x4bc339(0x115)][_0x4bc339(0xe2)]:0x0),console[_0x4bc339(0xbf)](_0x4bc339(0xe6),!!_0x326b14['hashedPassword']);if(!_0x326b14['salt']){console[_0x4bc339(0x86)](_0x4bc339(0x126));throw new Error(_0x4bc339(0xd1));}return console[_0x4bc339(0xbf)](_0x4bc339(0x11d)),!![];}catch(_0x5ce038){return console[_0x4bc339(0x86)](_0x4bc339(0xb8),_0x5ce038),console['error']('Error\x20stack:',_0x5ce038['stack']),![];}finally{console[_0x4bc339(0xce)](_0x4df560),console[_0x4bc339(0xbf)]('===\x20SETUP\x20PASSWORD\x20END\x20===');}}async[_0x425f00(0x117)](){const _0x853b93=_0x425f00;console['log'](_0x853b93(0x9b));try{this[_0x853b93(0x104)]='no-password-mode',await chrome[_0x853b93(0xc5)][_0x853b93(0xd2)][_0x853b93(0x132)]({'passwordSkipped':!![],'sessionKey':this[_0x853b93(0x104)]}),console[_0x853b93(0xbf)]('Password\x20setup\x20skipped\x20successfully'),this['isUnlocked']=!![],await this['persistUnlockStatus'](!![]);if(this['walletManager']){console[_0x853b93(0xbf)]('Initializing\x20wallet\x20manager\x20for\x20no-password\x20mode...');const _0x457c17=await this[_0x853b93(0xa0)]['initialize'](this['sessionKey']);_0x457c17?console[_0x853b93(0xbf)](_0x853b93(0xae)):console[_0x853b93(0xbf)](_0x853b93(0x110));}return console['log'](_0x853b93(0x89)),!![];}catch(_0x64323d){return console[_0x853b93(0x86)](_0x853b93(0xba),_0x64323d),![];}finally{console[_0x853b93(0xbf)](_0x853b93(0x93));}}async[_0x425f00(0xcf)](){const _0x3a2176=_0x425f00;console['log'](_0x3a2176(0x102));try{const _0x257b1e=await chrome[_0x3a2176(0xc5)]['local'][_0x3a2176(0xa3)]([_0x3a2176(0xf7),_0x3a2176(0x9c)]),_0x578719=!!_0x257b1e[_0x3a2176(0xf7)],_0x12f97b=!!_0x257b1e[_0x3a2176(0x9c)];return console[_0x3a2176(0xbf)](_0x3a2176(0x10c),{'hasPassword':_0x578719,'passwordSkipped':_0x12f97b}),_0x578719||_0x12f97b;}catch(_0x16fc3d){return console[_0x3a2176(0x86)]('Error\x20checking\x20password:',_0x16fc3d),![];}}async[_0x425f00(0xa5)](_0x3a53be){const _0x59069b=_0x425f00;console[_0x59069b(0xbf)](_0x59069b(0xe1));try{const _0x52d08a=new TextEncoder(),_0xa79eb9=_0x52d08a[_0x59069b(0xd3)](_0x3a53be),_0x428723=await crypto[_0x59069b(0xc0)][_0x59069b(0xe7)](_0x59069b(0xbc),_0xa79eb9),_0x5289b8=Array[_0x59069b(0xaa)](new Uint8Array(_0x428723)),_0x18869f=_0x5289b8[_0x59069b(0xab)](_0x255cc2=>_0x255cc2[_0x59069b(0x105)](0x10)[_0x59069b(0x77)](0x2,'0'))[_0x59069b(0x11f)]('');return console[_0x59069b(0xbf)](_0x59069b(0xd6)),_0x18869f;}catch(_0x296be4){console[_0x59069b(0x86)](_0x59069b(0xdf),_0x296be4);throw _0x296be4;}}async['verifyPassword'](_0x3e1d81){const _0x34c21f=_0x425f00;console[_0x34c21f(0xbf)](_0x34c21f(0xfa));try{const _0x577cc3=await chrome['storage'][_0x34c21f(0xd2)][_0x34c21f(0xa3)]([_0x34c21f(0xf7),'salt']);if(!_0x577cc3[_0x34c21f(0xf7)])return console['error'](_0x34c21f(0xc8)),![];let _0x127ed8;if(_0x577cc3[_0x34c21f(0x115)]){console['log'](_0x34c21f(0x109));const _0x3b52e1=new TextEncoder(),_0x5438ac=_0x3b52e1[_0x34c21f(0xd3)](_0x3e1d81+_0x577cc3[_0x34c21f(0x115)]),_0x3b70d0=await window[_0x34c21f(0x11c)][_0x34c21f(0xc0)][_0x34c21f(0xe7)]('SHA-256',_0x5438ac),_0x29a74c=Array[_0x34c21f(0xaa)](new Uint8Array(_0x3b70d0));_0x127ed8=_0x29a74c[_0x34c21f(0xab)](_0xdb206c=>_0xdb206c['toString'](0x10)[_0x34c21f(0x77)](0x2,'0'))[_0x34c21f(0x11f)]('');}else console[_0x34c21f(0xbf)](_0x34c21f(0xb0)),_0x127ed8=await this[_0x34c21f(0xa5)](_0x3e1d81);const _0x4052cd=_0x127ed8===_0x577cc3[_0x34c21f(0xf7)];return _0x4052cd?(this['sessionKey']=_0x3e1d81,this[_0x34c21f(0xf9)]=!![],await this['persistUnlockStatus'](),console['log'](_0x34c21f(0xaf))):console['log'](_0x34c21f(0x8f)),_0x4052cd;}catch(_0x1369dc){return console[_0x34c21f(0x86)](_0x34c21f(0xb1),_0x1369dc),![];}finally{console[_0x34c21f(0xbf)](_0x34c21f(0xe5));}}async[_0x425f00(0xca)](){const _0xfcc0f9=_0x425f00;console[_0xfcc0f9(0xbf)](_0xfcc0f9(0xd9));try{this['sessionKey']=null,this[_0xfcc0f9(0xf9)]=![],await chrome[_0xfcc0f9(0xc5)]['local'][_0xfcc0f9(0xfb)]([_0xfcc0f9(0x121),_0xfcc0f9(0xdb)]),this[_0xfcc0f9(0xa0)]&&this[_0xfcc0f9(0xa0)][_0xfcc0f9(0x10f)](),console[_0xfcc0f9(0xbf)](_0xfcc0f9(0xf3));}catch(_0x5794e2){console[_0xfcc0f9(0x86)](_0xfcc0f9(0x12f),_0x5794e2),console[_0xfcc0f9(0x86)](_0xfcc0f9(0xb2),_0x5794e2[_0xfcc0f9(0x11a)]);}finally{console[_0xfcc0f9(0xbf)]('===\x20LOCK\x20WALLET\x20END\x20===');}}[_0x425f00(0xf4)](){const _0x8eaa88=_0x425f00;return console['log'](_0x8eaa88(0x112),{'hasManager':!!this['walletManager'],'isUnlocked':this[_0x8eaa88(0xf9)]}),this[_0x8eaa88(0xa0)];}[_0x425f00(0x8c)](){const _0x27f838=_0x425f00;return console['log'](_0x27f838(0xe0),{'isUnlocked':this['isUnlocked'],'lastActivity':new Date(this[_0x27f838(0x88)])[_0x27f838(0xb4)](),'timeSinceActivity':(Date['now']()-this[_0x27f838(0x88)])/0x3e8}),this[_0x27f838(0xf9)];}[_0x425f00(0xc2)](){const _0x5ba91a=_0x425f00;console['log'](_0x5ba91a(0xdc)),this[_0x5ba91a(0x88)]=Date['now'](),this[_0x5ba91a(0x8d)]&&clearTimeout(this['autoLockTimer']),this[_0x5ba91a(0x106)]();}[_0x425f00(0x106)](){const _0x47c1ec=_0x425f00;console[_0x47c1ec(0xbf)]('Starting\x20auto-lock\x20timer\x20with\x20duration:',this[_0x47c1ec(0xf8)]);this[_0x47c1ec(0x8d)]&&(clearTimeout(this['autoLockTimer']),console[_0x47c1ec(0xbf)](_0x47c1ec(0x9d)));if(this['autoLockDuration']===0x0){console[_0x47c1ec(0xbf)](_0x47c1ec(0x10b));return;}chrome[_0x47c1ec(0xc5)][_0x47c1ec(0xd2)][_0x47c1ec(0xa3)]([_0x47c1ec(0xf7)])[_0x47c1ec(0x84)](_0x2f4146=>{const _0x59b2fd=_0x47c1ec,_0x5ef6dd=!!_0x2f4146[_0x59b2fd(0xf7)];if(!_0x5ef6dd){console[_0x59b2fd(0xbf)](_0x59b2fd(0xee));return;}console['log'](_0x59b2fd(0x10a)+this['autoLockDuration']+'\x20seconds'),this[_0x59b2fd(0x8d)]=setTimeout(()=>{const _0x309868=_0x59b2fd;this[_0x309868(0xf9)]&&(console[_0x309868(0xbf)](_0x309868(0xe9)),this[_0x309868(0xca)]());},this[_0x59b2fd(0xf8)]*0x3e8),console[_0x59b2fd(0xbf)](_0x59b2fd(0xad));});}['updateAutoLockDuration'](_0x2a6743){const _0x512320=_0x425f00;console[_0x512320(0xbf)]('Updating\x20auto-lock\x20duration:',_0x2a6743,_0x2a6743===0x0?'(Never)':'('+_0x2a6743+_0x512320(0xa1)),this[_0x512320(0xf8)]=_0x2a6743,this['resetAutoLockTimer']();}async[_0x425f00(0xf2)](){const _0x34b89c=_0x425f00;try{const _0x51054e=await chrome['storage'][_0x34b89c(0xd2)][_0x34b89c(0xa3)]([_0x34b89c(0xf8)]),_0x2358e6=_0x51054e[_0x34b89c(0xf8)]!==undefined?_0x51054e['autoLockDuration']:0x12c;console[_0x34b89c(0xbf)](_0x34b89c(0x123),_0x2358e6,_0x2358e6===0x0?_0x34b89c(0xda):'('+_0x2358e6+_0x34b89c(0xa1)),this['autoLockDuration']=_0x2358e6,await this[_0x34b89c(0x95)](),this['startAutoLockTimer']();}catch(_0x3b4af5){console[_0x34b89c(0x86)](_0x34b89c(0xd8),_0x3b4af5),this[_0x34b89c(0xf8)]=0x12c,await this['initializeUnlockStatus'](),this[_0x34b89c(0x106)]();}}async[_0x425f00(0x119)](_0xdf7b2b){const _0x2b7d78=_0x425f00;console[_0x2b7d78(0xbf)](_0x2b7d78(0xd7));try{const _0xe2af31=await window[_0x2b7d78(0x11c)][_0x2b7d78(0xd4)](new Uint8Array(0x20)),_0x93d8ff=btoa(String[_0x2b7d78(0xa7)][_0x2b7d78(0xea)](null,_0xe2af31)),_0x5975bb=new TextEncoder(),_0x549726=_0x5975bb[_0x2b7d78(0xd3)](_0xdf7b2b+_0x93d8ff),_0x53eddd=await window[_0x2b7d78(0x11c)]['subtle']['digest']('SHA-256',_0x549726),_0xfa4a57=Array['from'](new Uint8Array(_0x53eddd)),_0x349219=_0xfa4a57['map'](_0x3f535e=>_0x3f535e['toString'](0x10)[_0x2b7d78(0x77)](0x2,'0'))[_0x2b7d78(0x11f)]('');await chrome['storage'][_0x2b7d78(0xd2)][_0x2b7d78(0x132)]({'salt':_0x93d8ff,'hashedPassword':_0x349219,'initialized':!![]}),this['sessionKey']=_0xdf7b2b,this[_0x2b7d78(0xf9)]=!![],await this[_0x2b7d78(0x7c)](),console['log'](_0x2b7d78(0x12a));}catch(_0x228f93){console[_0x2b7d78(0x86)](_0x2b7d78(0xf0),_0x228f93);throw new Error(_0x2b7d78(0xb5)+_0x228f93[_0x2b7d78(0xde)]);}}async[_0x425f00(0x9f)](_0x585975){const _0x42f654=_0x425f00;console['log']('Setting\x20password...');try{return await this[_0x42f654(0x119)](_0x585975),!![];}catch(_0x423354){return console['error'](_0x42f654(0x114),_0x423354),![];}}async[_0x425f00(0x10f)](){const _0xd67a8a=_0x425f00;console[_0xd67a8a(0xbf)](_0xd67a8a(0xfe));try{this[_0xd67a8a(0x104)]=null,this[_0xd67a8a(0xf9)]=![],await chrome['storage'][_0xd67a8a(0xd2)][_0xd67a8a(0xfb)]([_0xd67a8a(0x121),_0xd67a8a(0xdb)]),this[_0xd67a8a(0xa0)]&&typeof this['walletManager'][_0xd67a8a(0x10f)]==='function'&&this[_0xd67a8a(0xa0)][_0xd67a8a(0x10f)](),this[_0xd67a8a(0x8d)]&&(clearTimeout(this[_0xd67a8a(0x8d)]),this[_0xd67a8a(0x8d)]=null),console['log'](_0xd67a8a(0x85));}catch(_0x3f9bf0){console['error'](_0xd67a8a(0xb6),_0x3f9bf0);}}async[_0x425f00(0x95)](){const _0x356c21=_0x425f00;try{const _0x3051e1=await chrome[_0x356c21(0xc5)][_0x356c21(0xd2)]['get']([_0x356c21(0x121),'lastUnlockTime',_0x356c21(0x9c),_0x356c21(0x104)]),_0x42f906=Date['now']();console['log']('Initializing\x20unlock\x20status:',{'walletUnlocked':_0x3051e1[_0x356c21(0x121)],'walletUnlockedType':typeof _0x3051e1['walletUnlocked'],'lastUnlockTime':_0x3051e1['lastUnlockTime'],'lastUnlockTimeType':typeof _0x3051e1[_0x356c21(0xdb)],'lastUnlockTimeFormatted':_0x3051e1[_0x356c21(0xdb)]?new Date(_0x3051e1['lastUnlockTime'])[_0x356c21(0xb4)]():null,'passwordSkipped':_0x3051e1['passwordSkipped'],'sessionKey':_0x3051e1[_0x356c21(0x104)],'autoLockDuration':this[_0x356c21(0xf8)],'autoLockDisabled':this[_0x356c21(0xf8)]===0x0,'autoLockDurationType':typeof this[_0x356c21(0xf8)],'storageKeys':Object['keys'](_0x3051e1),'fullStorage':_0x3051e1});if(_0x3051e1[_0x356c21(0x9c)]){console[_0x356c21(0xbf)](_0x356c21(0x118)),this[_0x356c21(0x104)]=_0x3051e1[_0x356c21(0x104)]||_0x356c21(0x101),this[_0x356c21(0xf9)]=!![],await this[_0x356c21(0x7c)](!![]),console[_0x356c21(0xbf)](_0x356c21(0xb9),this[_0x356c21(0x104)]);return;}if(_0x3051e1[_0x356c21(0x121)]&&_0x3051e1['lastUnlockTime']){const _0x400b79=_0x42f906-_0x3051e1[_0x356c21(0xdb)];console['log']('Time\x20since\x20unlock:',{'timeSinceUnlockMs':_0x400b79,'timeSinceUnlockSeconds':Math[_0x356c21(0xff)](_0x400b79/0x3e8),'autoLockDurationSeconds':this[_0x356c21(0xf8)]});if(this[_0x356c21(0xf8)]===0x0){console[_0x356c21(0xbf)](_0x356c21(0xcd)),this[_0x356c21(0xf9)]=!![];if(_0x3051e1[_0x356c21(0x104)]){this[_0x356c21(0x104)]=_0x3051e1[_0x356c21(0x104)],console[_0x356c21(0xbf)](_0x356c21(0xf5));if(this['walletManager']&&!this['walletManager'][_0x356c21(0x133)]()){console[_0x356c21(0xbf)](_0x356c21(0x128));try{const _0x138cbc=await this['walletManager'][_0x356c21(0xa9)](this[_0x356c21(0x104)]);_0x138cbc?console[_0x356c21(0xbf)](_0x356c21(0xbd)):console[_0x356c21(0x78)](_0x356c21(0x87));}catch(_0x1a09ad){console['error'](_0x356c21(0xcc),_0x1a09ad);}}}else console[_0x356c21(0x78)](_0x356c21(0x9e));await this[_0x356c21(0x7c)](![]);}else{const _0x55bb16=this[_0x356c21(0xf8)]*0x3e8;if(_0x400b79<_0x55bb16){console[_0x356c21(0xbf)](_0x356c21(0xb3)),this[_0x356c21(0xf9)]=!![];if(_0x3051e1['sessionKey']){this[_0x356c21(0x104)]=_0x3051e1[_0x356c21(0x104)],console[_0x356c21(0xbf)]('Session\x20key\x20restored\x20for\x20unlocked\x20state');if(this[_0x356c21(0xa0)]&&!this[_0x356c21(0xa0)][_0x356c21(0x133)]()){console[_0x356c21(0xbf)](_0x356c21(0xc4));try{const _0x98628b=await this[_0x356c21(0xa0)][_0x356c21(0xa9)](this[_0x356c21(0x104)]);_0x98628b?console['log']('Wallet\x20manager\x20initialized\x20successfully\x20on\x20startup'):console['warn'](_0x356c21(0xa4));}catch(_0x51f1cc){console['error'](_0x356c21(0x108),_0x51f1cc);}}}else console[_0x356c21(0x78)](_0x356c21(0x124));await this[_0x356c21(0x7c)](![]);}else console[_0x356c21(0xbf)]('Auto-lock\x20timer\x20expired\x20-\x20wallet\x20locked'),this[_0x356c21(0xf9)]=![],await chrome['storage']['local'][_0x356c21(0xfb)]([_0x356c21(0x121),_0x356c21(0xdb)]);}}else console[_0x356c21(0xbf)](_0x356c21(0xfd)),this[_0x356c21(0xf9)]=![];console[_0x356c21(0xbf)](_0x356c21(0x9a),this[_0x356c21(0xf9)]);}catch(_0x313db1){console[_0x356c21(0x86)]('Error\x20initializing\x20unlock\x20status:',_0x313db1),this['isUnlocked']=![];}}async['updateLastActivity'](){const _0x538834=_0x425f00;try{this[_0x538834(0xf9)]&&(await chrome['storage'][_0x538834(0xd2)]['set']({'lastUnlockTime':Date['now']()}),console['log'](_0x538834(0x7f)),this[_0x538834(0xc2)]());}catch(_0x562123){console[_0x538834(0x86)]('Error\x20updating\x20last\x20activity:',_0x562123);}}async['persistUnlockStatus'](_0x352e27=!![]){const _0x194572=_0x425f00;try{const _0x39b947={'walletUnlocked':this[_0x194572(0xf9)]};if(_0x352e27)_0x39b947[_0x194572(0xdb)]=Date[_0x194572(0xbb)](),console['log'](_0x194572(0xf1));else{console['log'](_0x194572(0xdd));const _0x6a5ab4=await chrome[_0x194572(0xc5)]['local']['get']([_0x194572(0xdb)]);_0x6a5ab4[_0x194572(0xdb)]?(_0x39b947[_0x194572(0xdb)]=_0x6a5ab4[_0x194572(0xdb)],console[_0x194572(0xbf)](_0x194572(0x80),new Date(_0x6a5ab4['lastUnlockTime'])[_0x194572(0xb4)]())):console[_0x194572(0xbf)]('No\x20existing\x20lastUnlockTime\x20found');}console['log'](_0x194572(0x12c),_0x39b947),await chrome[_0x194572(0xc5)][_0x194572(0xd2)]['set'](_0x39b947),console[_0x194572(0xbf)](_0x194572(0x11b),this[_0x194572(0xf9)]);const _0x18afa7=await chrome[_0x194572(0xc5)][_0x194572(0xd2)][_0x194572(0xa3)]([_0x194572(0x121),_0x194572(0xdb)]);console[_0x194572(0xbf)](_0x194572(0x12e),_0x18afa7);}catch(_0x5bb50e){console[_0x194572(0x86)](_0x194572(0x116),_0x5bb50e);}}async[_0x425f00(0xcb)](_0x26d8d9,_0x2c47f2){const _0x235165=_0x425f00;console['log'](_0x235165(0xec));try{console['log'](_0x235165(0x7b));const _0x3b03db=await this[_0x235165(0xe3)](_0x26d8d9);if(!_0x3b03db)return console[_0x235165(0x86)](_0x235165(0x122)),{'success':![],'error':_0x235165(0x7d)};console[_0x235165(0xbf)](_0x235165(0xbe));let _0x5edbd8=[];this[_0x235165(0xa0)]&&this[_0x235165(0xa0)]['isReady']()&&(_0x5edbd8=this['walletManager'][_0x235165(0xef)](),console[_0x235165(0xbf)](_0x235165(0x131)+_0x5edbd8[_0x235165(0xe2)]+_0x235165(0x8a)));if(!_0x2c47f2||_0x2c47f2['trim']()===''){console[_0x235165(0xbf)]('Removing\x20password\x20-\x20switching\x20to\x20no-password\x20mode'),await chrome[_0x235165(0xc5)][_0x235165(0xd2)][_0x235165(0xfb)]([_0x235165(0xf7),'salt']),await chrome[_0x235165(0xc5)][_0x235165(0xd2)][_0x235165(0x132)]({'passwordSkipped':!![],'sessionKey':_0x235165(0x101)}),this[_0x235165(0x104)]=_0x235165(0x101),this['isUnlocked']=!![];if(_0x5edbd8[_0x235165(0xe2)]>0x0){console[_0x235165(0xbf)](_0x235165(0x82));const _0x4fee0d=new WalletStorage(),_0x359a28=_0x5edbd8[_0x235165(0xc7)](_0xeff0ba=>_0xeff0ba[_0x235165(0x10e)])?.['id']||_0x5edbd8[0x0]?.['id'];await _0x4fee0d[_0x235165(0x103)](_0x5edbd8,_0x235165(0x101),_0x359a28),console['log'](_0x235165(0x97));}return await this[_0x235165(0x7c)](!![]),console[_0x235165(0xbf)](_0x235165(0xa2)),{'success':!![]};}console['log'](_0x235165(0x7a));if(_0x2c47f2[_0x235165(0xe2)]<0x8)return{'success':![],'error':'New\x20password\x20must\x20be\x20at\x20least\x208\x20characters\x20long'};const _0xb2ec36=this['calculatePasswordStrength'](_0x2c47f2);if(_0xb2ec36[_0x235165(0x107)]===_0x235165(0xfc))return{'success':![],'error':'New\x20password\x20is\x20too\x20weak.\x20Please\x20use\x20a\x20stronger\x20password.'};await this[_0x235165(0x119)](_0x2c47f2),await chrome[_0x235165(0xc5)]['local'][_0x235165(0xfb)]([_0x235165(0x9c)]);if(_0x5edbd8['length']>0x0){console['log']('Re-encrypting\x20wallets\x20with\x20new\x20password...');const _0x278b2f=new WalletStorage(),_0x52a66b=_0x5edbd8[_0x235165(0xc7)](_0x1121d4=>_0x1121d4[_0x235165(0x10e)])?.['id']||_0x5edbd8[0x0]?.['id'];await _0x278b2f['storeWallets'](_0x5edbd8,_0x2c47f2,_0x52a66b),console['log'](_0x235165(0x113));}return console[_0x235165(0xbf)](_0x235165(0x127)),{'success':!![]};}catch(_0x5957e3){return console[_0x235165(0x86)](_0x235165(0x100),_0x5957e3),{'success':![],'error':_0x5957e3[_0x235165(0xde)]};}finally{console[_0x235165(0xbf)](_0x235165(0xb7));}}}window[_0x425f00(0xac)]=PasswordManager;